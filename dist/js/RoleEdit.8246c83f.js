(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["RoleEdit"],{"0757":function(e,t,r){},"2fee":function(e,t,r){"use strict";var i=r("c2ce"),n=r.n(i);n.a},"59ed":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"privileges"},[r("b-btn",{staticClass:"mr-2",attrs:{variant:e.privs.member?"primary":"outline-primary",size:"sm"},on:{click:e.toggleMember}},[e._v("M")]),r("b-btn-group",{attrs:{size:"sm"}},[r("b-btn",{attrs:{variant:e.privs.roster?"primary":"outline-primary",size:"sm"},on:{click:e.toggleRoster}},[e._v("R")]),r("b-btn",{attrs:{variant:e.privs.contact?"primary":"outline-primary",size:"sm"},on:{click:e.toggleContact}},[e._v("C")]),r("b-btn",{attrs:{variant:e.privs.admin?"primary":"outline-primary",size:"sm"},on:{click:e.toggleAdmin}},[e._v("A")]),r("b-btn",{attrs:{variant:e.privs.events?"primary":"outline-primary",size:"sm"},on:{click:e.toggleEvents}},[e._v("E")]),r("b-btn",{attrs:{variant:e.privs.texts?"primary":"outline-primary",size:"sm"},on:{click:e.toggleTexts}},[e._v("T")]),r("b-btn",{attrs:{variant:e.privs.emails?"primary":"outline-primary",size:"sm"},on:{click:e.toggleEmails}},[e._v("@")]),r("b-btn",{attrs:{variant:e.privs.bcc?"primary":"outline-primary",size:"sm"},on:{click:e.toggleBCC}},[e._v("B")])],1)],1)},n=[];function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l={props:{privs:Object},model:{prop:"privs",event:"change"},methods:{toggleMember:function(){this.$emit("change",s({},this.privs,{member:!this.privs.member}))},toggleRoster:function(){var e=s({},this.privs,{roster:!this.privs.roster});e.roster||(e.contact=e.admin=e.events=e.texts=!1),this.$emit("change",e)},toggleContact:function(){var e=s({},this.privs,{contact:!this.privs.contact});e.contact?e.roster=!0:e.texts=!1,this.$emit("change",e)},toggleAdmin:function(){var e=s({},this.privs,{admin:!this.privs.admin});e.admin&&(e.roster=!0),this.$emit("change",e)},toggleEvents:function(){var e=s({},this.privs,{events:!this.privs.events});e.events&&(e.roster=!0),this.$emit("change",e)},toggleTexts:function(){var e=s({},this.privs,{texts:!this.privs.texts});e.texts&&(e.roster=e.contact=!0),this.$emit("change",e)},toggleEmails:function(){this.$emit("change",s({},this.privs,{emails:!this.privs.emails}))},toggleBCC:function(){this.$emit("change",s({},this.privs,{bcc:!this.privs.bcc}))}}},c=l,u=(r("bfe6"),r("2877")),p=Object(u["a"])(c,i,n,!1,null,null,null);t["a"]=p.exports},a34a:function(e,t,r){e.exports=r("96cf")},bfe6:function(e,t,r){"use strict";var i=r("0757"),n=r.n(i);n.a},c2ce:function(e,t,r){},ddcc:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.role?r("form",{attrs:{id:"role-edit"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("b-form-group",{attrs:{label:"Role name","label-for":"role-name","label-cols-sm":"auto","label-class":"role-edit-label",state:!e.nameError&&null,"invalid-feedback":e.nameError}},[r("b-input",{attrs:{id:"role-edit-name",autofocus:"",state:!e.nameError&&null,trim:""},model:{value:e.role.name,callback:function(t){e.$set(e.role,"name",t)},expression:"role.name"}})],1),r("b-form-group",{attrs:{label:"Flags","label-cols-sm":"auto","label-class":"role-edit-label pt-0"}},[r("div",{attrs:{id:"role-edit-flags"}},[r("b-checkbox",{model:{value:e.role.individual,callback:function(t){e.$set(e.role,"individual",t)},expression:"role.individual"}},[e._v("Individual (one person only)")])],1)]),r("div",{attrs:{id:"role-edit-privs"}},[r("div",{staticClass:"role-edit-group role-edit-heading"},[e._v("Group")]),r("div",{staticClass:"role-edit-privs role-edit-heading"},[e._v("Privileges ("),r("b-link",{directives:[{name:"b-modal",rawName:"v-b-modal.role-edit-priv-key",modifiers:{"role-edit-priv-key":!0}}],attrs:{href:"#"}},[e._v("Key")]),e._v(")"),r("b-modal",{attrs:{id:"role-edit-priv-key",title:"Privileges Key","ok-only":""}},[r("div",{attrs:{id:"role-edit-priv-key-body"}},[r("div",{staticClass:"mb-2"},[e._v("M = Role conveys membership in group")]),r("div",[e._v("R = Role allows viewing group roster")]),r("div",[e._v("C = Role allows viewing contact info of group members")]),r("div",[e._v("A = Role allows administration of group (adding/removing members)")]),r("div",[e._v("E = Role allows management of events for group")]),r("div",[e._v("T = Role allows sending text messages to group")]),r("div",[e._v("@ = Role allows sending email messages to group")]),r("div",[e._v("B = Role gets bcc'd on email messages to group")])])])],1),e._l(e.privs,(function(t,i){return[r("div",{staticClass:"role-edit-group",domProps:{textContent:e._s(t.name)}}),r("Privileges",{staticClass:"role-edit-privs",model:{value:e.privs[i],callback:function(t){e.$set(e.privs,i,t)},expression:"privs[i]"}})]}))],2),r("div",{staticClass:"mt-3"},[r("b-btn",{attrs:{type:"submit",variant:"primary",disabled:!e.valid},domProps:{textContent:e._s(e.newr?"Create Role":"Save Role")}}),r("b-btn",{staticClass:"ml-2",on:{click:e.onCancel}},[e._v("Cancel")]),e.newr?e._e():r("b-btn",{staticClass:"ml-5",on:{click:e.onClone}},[e._v("Clone Role")]),e.canDelete?r("b-btn",{staticClass:"ml-2",attrs:{variant:"danger"},on:{click:e.onDelete}},[e._v("Delete Role")]):e._e()],1)],1):r("div",{staticClass:"mt-3 ml-2"},[r("b-spinner",{attrs:{small:""}})],1)},n=[],a=r("a34a"),s=r.n(a),o=r("59ed");function l(e,t,r,i,n,a,s){try{var o=e[a](s),l=o.value}catch(c){return void r(c)}o.done?t(l):Promise.resolve(l).then(i,n)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var a=e.apply(t,r);function s(e){l(a,i,n,s,o,"next",e)}function o(e){l(a,i,n,s,o,"throw",e)}s(void 0)}))}}var u={components:{Privileges:o["a"]},props:{onLoadRole:Function},data:function(){return{role:null,privs:null,canDelete:!1,submitted:!1,nameError:null,duplicateName:null}},computed:{newr:function(){return"NEW"===this.$route.params.rid},valid:function(){return!this.nameError}},watch:{$route:"onChangeRoute","role.name":"validate"},created:function(){this.onChangeRoute()},methods:{onCancel:function(){this.$router.go(-1)},onChangeRoute:function(){var e=c(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$route.params.clone||this.$route.params.rid,e.next=3,this.$axios.get("/api/roles/".concat(t));case 3:r=e.sent.data,this.role=r.role,this.privs=r.privs,this.canDelete=r.canDelete&&"NEW"!==this.$route.params.rid,this.onLoadRole(this.role);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onClone:function(){this.$router.push({name:"roles-rid",params:{rid:"NEW",clone:this.$route.params.rid}})},onDelete:function(){var e=c(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$bvModal.msgBoxConfirm("Are you sure you want to delete this role?  All associated data, including privileges and memberships, will be permanently lost.",{title:"Delete Role",headerBgVariant:"danger",headerTextVariant:"white",okTitle:"Delete",okVariant:"danger",cancelTitle:"Keep"}).catch((function(e){}));case 2:if(t=e.sent,t){e.next=5;break}return e.abrupt("return");case 5:return r=new FormData,r.append("delete","true"),e.next=9,this.$axios.post("/api/roles/".concat(this.$route.params.rid),r);case 9:this.$router.push("/admin/roles");case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onSubmit:function(){var e=c(s.a.mark((function e(){var t,r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.submitted=!0,this.validate(),this.valid){e.next=4;break}return e.abrupt("return");case 4:return t=new FormData,t.append("name",this.role.name),t.append("individual",this.role.individual),this.privs.forEach((function(e){e.member&&t.append("member:".concat(e.id),!0),e.roster&&t.append("roster:".concat(e.id),!0),e.contact&&t.append("contact:".concat(e.id),!0),e.admin&&t.append("admin:".concat(e.id),!0),e.events&&t.append("events:".concat(e.id),!0),e.texts&&t.append("texts:".concat(e.id),!0),e.emails&&t.append("emails:".concat(e.id),!0),e.bcc&&t.append("bcc:".concat(e.id),!0)})),e.next=10,this.$axios.post("/api/roles/".concat(this.$route.params.rid),t);case 10:r=e.sent.data,r&&r.duplicateName?this.duplicateName=this.role.name:this.$router.push("/admin/roles");case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),validate:function(){this.submitted&&(this.role.name?this.duplicateName&&this.duplicateName===this.role.name?this.nameError="Another role has this name.":this.nameError=null:this.nameError="The role name is required.")}}},p=u,m=(r("2fee"),r("2877")),v=Object(m["a"])(p,i,n,!1,null,null,null);t["default"]=v.exports}}]);
//# sourceMappingURL=RoleEdit.8246c83f.js.map