(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["GroupEdit"],{"0757":function(e,t,r){},"59ed":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"privileges"},[r("b-btn",{staticClass:"mr-2",attrs:{variant:e.privs.member?"primary":"outline-primary",size:"sm"},on:{click:e.toggleMember}},[e._v("M")]),r("b-btn-group",{attrs:{size:"sm"}},[r("b-btn",{attrs:{variant:e.privs.roster?"primary":"outline-primary",size:"sm"},on:{click:e.toggleRoster}},[e._v("R")]),r("b-btn",{attrs:{variant:e.privs.contact?"primary":"outline-primary",size:"sm"},on:{click:e.toggleContact}},[e._v("C")]),r("b-btn",{attrs:{variant:e.privs.admin?"primary":"outline-primary",size:"sm"},on:{click:e.toggleAdmin}},[e._v("A")]),r("b-btn",{attrs:{variant:e.privs.events?"primary":"outline-primary",size:"sm"},on:{click:e.toggleEvents}},[e._v("E")]),r("b-btn",{attrs:{variant:e.privs.folders?"primary":"outline-primary",size:"sm"},on:{click:e.toggleFolders}},[e._v("F")]),r("b-btn",{attrs:{variant:e.privs.texts?"primary":"outline-primary",size:"sm"},on:{click:e.toggleTexts}},[e._v("T")]),r("b-btn",{attrs:{variant:e.privs.emails?"primary":"outline-primary",size:"sm"},on:{click:e.toggleEmails}},[e._v("@")]),r("b-btn",{attrs:{variant:e.privs.bcc?"primary":"outline-primary",size:"sm"},on:{click:e.toggleBCC}},[e._v("B")])],1)],1)},a=[];function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l={props:{privs:Object},model:{prop:"privs",event:"change"},methods:{toggleMember:function(){this.$emit("change",o({},this.privs,{member:!this.privs.member}))},toggleRoster:function(){var e=o({},this.privs,{roster:!this.privs.roster});e.roster||(e.contact=e.admin=e.events=e.texts=!1),this.$emit("change",e)},toggleContact:function(){var e=o({},this.privs,{contact:!this.privs.contact});e.contact?e.roster=!0:e.texts=!1,this.$emit("change",e)},toggleAdmin:function(){var e=o({},this.privs,{admin:!this.privs.admin});e.admin&&(e.roster=!0),this.$emit("change",e)},toggleEvents:function(){var e=o({},this.privs,{events:!this.privs.events});e.events&&(e.roster=!0),this.$emit("change",e)},toggleTexts:function(){var e=o({},this.privs,{texts:!this.privs.texts});e.texts&&(e.roster=e.contact=!0),this.$emit("change",e)},toggleEmails:function(){this.$emit("change",o({},this.privs,{emails:!this.privs.emails}))},toggleBCC:function(){this.$emit("change",o({},this.privs,{bcc:!this.privs.bcc}))},toggleFolders:function(){this.$emit("change",o({},this.privs,{folders:!this.privs.folders}))}}},u=l,p=(r("bfe6"),r("2877")),c=Object(p["a"])(u,i,a,!1,null,null,null);t["a"]=c.exports},"62b6":function(e,t,r){},a34a:function(e,t,r){e.exports=r("96cf")},ab7b:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.group?r("form",{attrs:{id:"group-edit"},on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("b-form-group",{attrs:{label:"Group name","label-for":"group-name","label-cols-sm":"auto","label-class":"group-edit-label",state:!e.nameError&&null,"invalid-feedback":e.nameError}},[r("b-input",{attrs:{id:"group-edit-name",autofocus:"",state:!e.nameError&&null,trim:""},model:{value:e.group.name,callback:function(t){e.$set(e.group,"name",t)},expression:"group.name"}})],1),r("b-form-group",{attrs:{label:"Group email","label-for":"group-email","label-cols-sm":"auto","label-class":"group-edit-label",state:!e.emailError&&null,"invalid-feedback":e.emailError}},[r("b-input",{attrs:{id:"group-edit-email",state:!e.emailError&&null,trim:""},model:{value:e.group.email,callback:function(t){e.$set(e.group,"email",t)},expression:"group.email"}}),r("b-form-text",[e._v("@sunnyvaleserv.org")])],1),r("b-form-group",{attrs:{label:"Flags","label-cols-sm":"auto","label-class":"group-edit-label pt-0"}},[r("div",{attrs:{id:"group-edit-flags"}},[r("b-checkbox",{model:{value:e.group.getHours,callback:function(t){e.$set(e.group,"getHours",t)},expression:"group.getHours"}},[e._v("Request volunteer hours from this group")]),r("b-checkbox",{model:{value:e.group.dswRequired,callback:function(t){e.$set(e.group,"dswRequired",t)},expression:"group.dswRequired"}},[e._v("DSW registration required for this group")]),r("b-checkbox",{model:{value:e.group.backgroundCheckRequired,callback:function(t){e.$set(e.group,"backgroundCheckRequired",t)},expression:"group.backgroundCheckRequired"}},[e._v("Background check required for this group")])],1)]),r("b-form-group",{attrs:{label:"Organization for volunteer hours tracking:"}},[r("b-form-radio-group",{attrs:{stacked:"",options:e.organizations},scopedSlots:e._u([{key:"first",fn:function(){return[r("b-form-radio",{attrs:{value:""}},[e._v("(none)")])]},proxy:!0}]),model:{value:e.group.organization,callback:function(t){e.$set(e.group,"organization",t)},expression:"group.organization"}})],1),r("div",{attrs:{id:"group-edit-privs"}},[r("div",{staticClass:"group-edit-role group-edit-heading"},[e._v("Role")]),r("div",{staticClass:"group-edit-privs group-edit-heading"},[e._v("Privileges ("),r("b-link",{directives:[{name:"b-modal",rawName:"v-b-modal.group-edit-priv-key",modifiers:{"group-edit-priv-key":!0}}],attrs:{href:"#"}},[e._v("Key")]),e._v(")"),r("b-modal",{attrs:{id:"group-edit-priv-key",title:"Privileges Key","ok-only":""}},[r("div",{attrs:{id:"group-edit-priv-key-body"}},[r("div",{staticClass:"mb-2"},[e._v("M = Role conveys membership in group")]),r("div",[e._v("R = Role allows viewing group roster")]),r("div",[e._v("C = Role allows viewing contact info of group members")]),r("div",[e._v("A = Role allows administration of group (adding/removing members)")]),r("div",[e._v("E = Role allows management of events for group")]),r("div",[e._v("F = Role allows management of files for group")]),r("div",[e._v("T = Role allows sending text messages to group")]),r("div",[e._v("@ = Role allows sending email messages to group")]),r("div",[e._v("B = Role gets bcc'd on email messages to group")])])])],1),e._l(e.privs,(function(t,i){return[r("div",{staticClass:"group-edit-role",domProps:{textContent:e._s(t.name)}}),r("Privileges",{staticClass:"group-edit-privs",model:{value:e.privs[i],callback:function(t){e.$set(e.privs,i,t)},expression:"privs[i]"}})]}))],2),e.group.noEmail&&e.group.noEmail.length?r("div",{staticClass:"mt-3"},[r("div",[e._v("Unsubscribed from emails to this group:")]),e._l(e.group.noEmail,(function(t){return r("div",{domProps:{textContent:e._s(t)}})}))],2):e._e(),e.group.noText&&e.group.noText.length?r("div",{staticClass:"mt-3"},[r("div",[e._v("Unsubscribed from text messages to this group:")]),e._l(e.group.noText,(function(t){return r("div",{domProps:{textContent:e._s(t)}})}))],2):e._e(),r("div",{staticClass:"mt-3"},[r("b-btn",{attrs:{type:"submit",variant:"primary",disabled:!e.valid},domProps:{textContent:e._s(e.newg?"Create Group":"Save Group")}}),r("b-btn",{staticClass:"ml-2",on:{click:e.onCancel}},[e._v("Cancel")]),e.newg?e._e():r("b-btn",{staticClass:"ml-5",on:{click:e.onClone}},[e._v("Clone Group")]),e.canDelete?r("b-btn",{staticClass:"ml-2",attrs:{variant:"danger"},on:{click:e.onDelete}},[e._v("Delete Group")]):e._e()],1)],1):r("div",{staticClass:"mt-3 ml-2"},[r("b-spinner",{attrs:{small:""}})],1)},a=[],n=r("a34a"),o=r.n(n),s=r("59ed");function l(e,t,r,i,a,n,o){try{var s=e[n](o),l=s.value}catch(u){return void r(u)}s.done?t(l):Promise.resolve(l).then(i,a)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(i,a){var n=e.apply(t,r);function o(e){l(n,i,a,o,s,"next",e)}function s(e){l(n,i,a,o,s,"throw",e)}o(void 0)}))}}var p={components:{Privileges:s["a"]},props:{onLoadGroup:Function},data:function(){return{group:null,privs:null,canDelete:!1,submitted:!1,nameError:null,duplicateName:null,emailError:null,duplicateEmail:null,organizations:null}},computed:{newg:function(){return"NEW"===this.$route.params.gid},valid:function(){return!this.nameError}},watch:{$route:"onChangeRoute","group.name":"validate","group.email":"validate"},created:function(){this.onChangeRoute()},methods:{onCancel:function(){this.$router.go(-1)},onChangeRoute:function(){var e=u(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.$route.params.clone||this.$route.params.gid,e.next=3,this.$axios.get("/api/groups/".concat(t));case 3:r=e.sent.data,this.group=r.group,this.privs=r.privs,this.canDelete=r.canDelete&&"NEW"!==this.$route.params.gid,this.organizations=r.organizations,this.onLoadGroup(this.group);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onClone:function(){this.$router.push({name:"groups-gid",params:{gid:"NEW",clone:this.$route.params.gid}})},onDelete:function(){var e=u(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$bvModal.msgBoxConfirm("Are you sure you want to delete this group?  All associated data, including privileges and memberships, will be permanently lost.",{title:"Delete Group",headerBgVariant:"danger",headerTextVariant:"white",okTitle:"Delete",okVariant:"danger",cancelTitle:"Keep"}).catch((function(e){}));case 2:if(t=e.sent,t){e.next=5;break}return e.abrupt("return");case 5:return r=new FormData,r.append("delete","true"),e.next=9,this.$axios.post("/api/groups/".concat(this.$route.params.gid),r);case 9:this.$router.push("/admin/groups");case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onSubmit:function(){var e=u(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.submitted=!0,this.validate(),this.valid){e.next=4;break}return e.abrupt("return");case 4:return t=new FormData,t.append("name",this.group.name),t.append("email",this.group.email),t.append("getHours",this.group.getHours),t.append("dswRequired",this.group.dswRequired),t.append("backgroundCheckRequired",this.group.backgroundCheckRequired),t.append("organization",this.group.organization),this.privs.forEach((function(e){e.member&&t.append("member:".concat(e.id),!0),e.roster&&t.append("roster:".concat(e.id),!0),e.contact&&t.append("contact:".concat(e.id),!0),e.admin&&t.append("admin:".concat(e.id),!0),e.events&&t.append("events:".concat(e.id),!0),e.texts&&t.append("texts:".concat(e.id),!0),e.emails&&t.append("emails:".concat(e.id),!0),e.bcc&&t.append("bcc:".concat(e.id),!0),e.folders&&t.append("folders:".concat(e.id),!0)})),e.next=14,this.$axios.post("/api/groups/".concat(this.$route.params.gid),t);case 14:r=e.sent.data,r?(r.duplicateName&&(this.duplicateName=this.group.name),r.duplicateEmail&&(this.duplicateEmail=this.group.email)):this.$router.push("/admin/groups");case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),validate:function(){this.submitted&&(this.group.name?this.duplicateName&&this.duplicateName===this.group.name?this.nameError="Another group has this name.":this.nameError=null:this.nameError="The group name is required.",this.group.email?this.group.email.match(/^[a-zA-Z][-a-zA-Z0-9]*$/)?this.duplicateEmail&&this.duplicateEmail===this.group.email?this.emailError="Another group has this email list name.":this.emailError=null:this.emailError="This is not a valid email list name.  Letters, digits, and hyphens only.":this.emailError=null)}}},c=p,m=(r("f6ab"),r("2877")),d=Object(m["a"])(c,i,a,!1,null,null,null);t["default"]=d.exports},bfe6:function(e,t,r){"use strict";var i=r("0757"),a=r.n(i);a.a},f6ab:function(e,t,r){"use strict";var i=r("62b6"),a=r.n(i);a.a}}]);
//# sourceMappingURL=GroupEdit.c03fa4e5.js.map