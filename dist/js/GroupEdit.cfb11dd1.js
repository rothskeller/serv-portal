(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["GroupEdit"],{"0757":function(t,e,r){},"59ed":function(t,e,r){"use strict";var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"privileges"},[r("b-btn",{staticClass:"mr-2",attrs:{variant:t.privs.member?"primary":"outline-primary",size:"sm"},on:{click:t.toggleMember}},[t._v("M")]),r("b-btn-group",{attrs:{size:"sm"}},[r("b-btn",{attrs:{variant:t.privs.roster?"primary":"outline-primary",size:"sm"},on:{click:t.toggleRoster}},[t._v("R")]),r("b-btn",{attrs:{variant:t.privs.contact?"primary":"outline-primary",size:"sm"},on:{click:t.toggleContact}},[t._v("C")]),r("b-btn",{attrs:{variant:t.privs.admin?"primary":"outline-primary",size:"sm"},on:{click:t.toggleAdmin}},[t._v("A")]),r("b-btn",{attrs:{variant:t.privs.events?"primary":"outline-primary",size:"sm"},on:{click:t.toggleEvents}},[t._v("E")]),r("b-btn",{attrs:{variant:t.privs.texts?"primary":"outline-primary",size:"sm"},on:{click:t.toggleTexts}},[t._v("T")])],1)],1)},a=[];function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l={props:{privs:Object},model:{prop:"privs",event:"change"},methods:{toggleMember:function(){this.$emit("change",s({},this.privs,{member:!this.privs.member}))},toggleRoster:function(){var t=s({},this.privs,{roster:!this.privs.roster});t.roster||(t.contact=t.admin=t.events=t.texts=!1),this.$emit("change",t)},toggleContact:function(){var t=s({},this.privs,{contact:!this.privs.contact});t.contact?t.roster=!0:t.texts=!1,this.$emit("change",t)},toggleAdmin:function(){var t=s({},this.privs,{admin:!this.privs.admin});t.admin&&(t.roster=!0),this.$emit("change",t)},toggleEvents:function(){var t=s({},this.privs,{events:!this.privs.events});t.events&&(t.roster=!0),this.$emit("change",t)},toggleTexts:function(){var t=s({},this.privs,{texts:!this.privs.texts});t.texts&&(t.roster=t.contact=!0),this.$emit("change",t)}}},u=l,p=(r("bfe6"),r("2877")),c=Object(p["a"])(u,i,a,!1,null,null,null);e["a"]=c.exports},"7bd8":function(t,e,r){"use strict";var i=r("81d1"),a=r.n(i);a.a},"81d1":function(t,e,r){},a34a:function(t,e,r){t.exports=r("96cf")},bfe6:function(t,e,r){"use strict";var i=r("0757"),a=r.n(i);a.a},d930:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.group?r("form",{attrs:{id:"group-edit"},on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[r("b-form-group",{attrs:{label:"Group name","label-for":"group-name","label-cols-sm":"auto","label-class":"group-edit-label",state:!t.nameError&&null,"invalid-feedback":t.nameError}},[r("b-input",{attrs:{id:"group-edit-name",autofocus:"",state:!t.nameError&&null,trim:""},model:{value:t.group.name,callback:function(e){t.$set(t.group,"name",e)},expression:"group.name"}})],1),r("b-form-group",{attrs:{label:"Group email","label-for":"group-email","label-cols-sm":"auto","label-class":"group-edit-label",state:!t.emailError&&null,"invalid-feedback":t.emailError}},[r("b-input",{attrs:{id:"group-edit-email",state:!t.emailError&&null,trim:""},model:{value:t.group.email,callback:function(e){t.$set(t.group,"email",e)},expression:"group.email"}}),r("b-form-text",[t._v("@sunnyvaleserv.org")])],1),r("b-form-group",{attrs:{label:"Flags","label-cols-sm":"auto","label-class":"group-edit-label pt-0"}},[r("div",{attrs:{id:"group-edit-flags"}},[r("b-checkbox",{model:{value:t.group.allowTextMessages,callback:function(e){t.$set(t.group,"allowTextMessages",e)},expression:"group.allowTextMessages"}},[t._v("Can send text messages to group")])],1)]),r("div",{attrs:{id:"group-edit-privs"}},[r("div",{staticClass:"group-edit-role group-edit-heading"},[t._v("Role")]),r("div",{staticClass:"group-edit-privs group-edit-heading"},[t._v("Privileges ("),r("b-link",{directives:[{name:"b-modal",rawName:"v-b-modal.group-edit-priv-key",modifiers:{"group-edit-priv-key":!0}}],attrs:{href:"#"}},[t._v("Key")]),t._v(")"),r("b-modal",{attrs:{id:"group-edit-priv-key",title:"Privileges Key","ok-only":""}},[r("div",{attrs:{id:"group-edit-priv-key-body"}},[r("div",{staticClass:"mb-2"},[t._v("M = Role conveys membership in group")]),r("div",[t._v("R = Role allows viewing group roster")]),r("div",[t._v("C = Role allows viewing contact info of group members")]),r("div",[t._v("A = Role allows administration of group (adding/removing members)")]),r("div",[t._v("E = Role allows management of events for group")]),r("div",[t._v("T = Role allows sending text messages to group")])])])],1),t._l(t.privs,(function(e,i){return[r("div",{staticClass:"group-edit-role",domProps:{textContent:t._s(e.name)}}),r("Privileges",{staticClass:"group-edit-privs",model:{value:t.privs[i],callback:function(e){t.$set(t.privs,i,e)},expression:"privs[i]"}})]}))],2),r("div",{staticClass:"mt-3"},[r("b-btn",{attrs:{type:"submit",variant:"primary",disabled:!t.valid},domProps:{textContent:t._s(t.newg?"Create Group":"Save Group")}}),r("b-btn",{staticClass:"ml-2",on:{click:t.onCancel}},[t._v("Cancel")]),t.canDelete?r("b-btn",{staticClass:"ml-5",attrs:{variant:"danger"},on:{click:t.onDelete}},[t._v("Delete Group")]):t._e()],1)],1):r("div",{staticClass:"mt-3 ml-2"},[r("b-spinner",{attrs:{small:""}})],1)},a=[],n=r("a34a"),s=r.n(n),o=r("59ed");function l(t,e,r,i,a,n,s){try{var o=t[n](s),l=o.value}catch(u){return void r(u)}o.done?e(l):Promise.resolve(l).then(i,a)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(i,a){var n=t.apply(e,r);function s(t){l(n,i,a,s,o,"next",t)}function o(t){l(n,i,a,s,o,"throw",t)}s(void 0)}))}}var p={components:{Privileges:o["a"]},props:{onLoadGroup:Function},data:function(){return{group:null,privs:null,canDelete:!1,submitted:!1,nameError:null,duplicateName:null,emailError:null,duplicateEmail:null}},computed:{newg:function(){return"NEW"===this.$route.params.id},valid:function(){return!this.nameError}},watch:{"group.name":"validate","group.email":"validate"},created:function(){var t=u(s.a.mark((function t(){var e;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$axios.get("/api/groups/".concat(this.$route.params.id));case 2:e=t.sent.data,this.group=e.group,this.privs=e.privs,this.canDelete=e.canDelete,this.onLoadGroup(this.group);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{onCancel:function(){this.$router.go(-1)},onDelete:function(){var t=u(s.a.mark((function t(){var e,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$bvModal.msgBoxConfirm("Are you sure you want to delete this group?  All associated data, including privileges and memberships, will be permanently lost.",{title:"Delete Group",headerBgVariant:"danger",headerTextVariant:"white",okTitle:"Delete",okVariant:"danger",cancelTitle:"Keep"}).catch((function(t){}));case 2:if(e=t.sent,e){t.next=5;break}return t.abrupt("return");case 5:return r=new FormData,r.append("delete","true"),t.next=9,this.$axios.post("/api/groups/".concat(this.$route.params.id),r);case 9:this.$router.push("/groups");case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onSubmit:function(){var t=u(s.a.mark((function t(){var e,r;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.submitted=!0,this.validate(),this.valid){t.next=4;break}return t.abrupt("return");case 4:return e=new FormData,e.append("name",this.group.name),e.append("email",this.group.email),e.append("allowTextMessages",this.group.allowTextMessages),this.privs.forEach((function(t){t.member&&e.append("member:".concat(t.id),!0),t.roster&&e.append("roster:".concat(t.id),!0),t.contact&&e.append("contact:".concat(t.id),!0),t.admin&&e.append("admin:".concat(t.id),!0),t.events&&e.append("events:".concat(t.id),!0),t.texts&&e.append("texts:".concat(t.id),!0)})),t.next=11,this.$axios.post("/api/groups/".concat(this.$route.params.id),e);case 11:r=t.sent.data,r?(r.duplicateName&&(this.duplicateName=this.group.name),r.duplicateEmail&&(this.duplicateEmail=this.group.email)):this.$router.push("/groups");case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),validate:function(){this.submitted&&(this.group.name?this.duplicateName&&this.duplicateName===this.group.name?this.nameError="Another group has this name.":this.nameError=null:this.nameError="The group name is required.",this.group.email?this.group.email.match(/^[a-zA-Z][-a-zA-Z0-9]*$/)?this.duplicateEmail&&this.duplicateEmail===this.group.email?this.emailError="Another group has this email list name.":this.emailError=null:this.emailError="This is not a valid email list name.  Letters, digits, and hyphens only.":this.emailError=null)}}},c=p,m=(r("7bd8"),r("2877")),d=Object(m["a"])(c,i,a,!1,null,null,null);e["default"]=d.exports}}]);
//# sourceMappingURL=GroupEdit.cfb11dd1.js.map