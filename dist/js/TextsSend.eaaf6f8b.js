(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TextsSend"],{"1ef7":function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return e.groups?t("b-form",{attrs:{id:"texts-send"},on:{submit:function(s){return s.preventDefault(),e.onSubmit(s)}}},[t("b-form-group",{attrs:{label:"Message","label-for":"texts-send-message","label-cols-sm":"auto","label-class":"texts-send-label",state:!e.messageError&&null,invalidFeedback:e.messageError}},[t("b-textarea",{attrs:{id:"texts-send-message",autofocus:""},model:{value:e.message,callback:function(s){e.message=s},expression:"message"}}),e.countMessage?t("b-form-text",[e._v(e._s(e.countMessage))]):e._e()],1),t("b-form-group",{attrs:{label:"Recipients","label-for":"texts-send-groups","label-cols-sm":"auto","label-class":"texts-send-label pt-0",state:!e.groupsError&&null,invalidFeedback:e.groupsError}},[t("b-form-checkbox-group",{attrs:{id:"texts-send-groups",options:e.groups,stacked:"","text-field":"name","value-field":"id"},model:{value:e.recipients,callback:function(s){e.recipients=s},expression:"recipients"}})],1),t("div",{staticClass:"mt-3"},[t("b-button",{attrs:{type:"submit",variant:"primary",disabled:e.sending||!e.valid}},[e.sending?t("b-spinner",{attrs:{small:""}}):t("span",[e._v("Send Message")])],1)],1)],1):t("div",{staticClass:"mt-3 ml-2"},[t("b-spinner",{attrs:{small:""}})],1)},a=[],n=t("a34a"),i=t.n(n);function o(e,s,t,r,a,n,i){try{var o=e[n](i),u=o.value}catch(c){return void t(c)}o.done?s(u):Promise.resolve(u).then(r,a)}function u(e){return function(){var s=this,t=arguments;return new Promise((function(r,a){var n=e.apply(s,t);function i(e){o(n,r,a,i,u,"next",e)}function u(e){o(n,r,a,i,u,"throw",e)}i(void 0)}))}}var c={data:function(){return{groups:null,message:"",recipients:[],countMessage:"0/160",messageError:null,groupsError:null,submitted:!1,sending:!1}},created:function(){var e=u(i.a.mark((function e(){var s;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/api/sms/NEW");case 2:s=e.sent.data,this.groups=s.groups;case 4:case"end":return e.stop()}}),e,this)})));function s(){return e.apply(this,arguments)}return s}(),watch:{message:"validate",recipients:"validate"},computed:{valid:function(){return!this.messageError&&!this.groupsError}},methods:{onSubmit:function(){var e=u(i.a.mark((function e(){var s,t;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.submitted=!0,this.validate(),this.valid){e.next=4;break}return e.abrupt("return");case 4:return s=new FormData,s.append("message",this.message),this.recipients.forEach((function(e){return s.append("group",e)})),this.sending=!0,e.next=10,this.$axios.post("/api/sms",s);case 10:t=e.sent.data,this.sending=!1,this.$router.push("/texts/".concat(t.id));case 13:case"end":return e.stop()}}),e,this)})));function s(){return e.apply(this,arguments)}return s}(),validate:function(){var e=!1,s=0,t=0,r=!0,a=!1,n=void 0;try{for(var i,o=this.message[Symbol.iterator]();!(r=(i=o.next()).done);r=!0){var u=i.value;s++,"Â£$Â¥Ã¨Ã©Ã¹Ã¬Ã²Ã‡\nÃ˜Ã¸\rÃ…Ã¥Î”_Î¦Î“Î›Î©Î Î¨Î£Î˜ÎžÃ†Ã¦ÃŸÃ‰ !\"#Â¤%&'()*+,-./0123456789:;<=>?Â¡ABCDEFGHIJKLMNOPQRSTUVWXYZÃ„Ã–Ã‘ÃœÂ§Â¿abcdefghijklmnopqrstuvwxyzÃ¤Ã¶Ã±Ã¼Ã ".includes(u)?t++:"\f\n^{}\\[~]|â‚¬".includes(u)?t+=2:e=!0}}catch(c){a=!0,n=c}finally{try{r||null==o.return||o.return()}finally{if(a)throw n}}e&&s>70?(this.messageError="This message is too long.  It has ".concat(s," characters.  The limit is 70 when unusual characters are used."),this.countMessage=""):!e&&t>160?(this.messageError="This message is too long.  It has ".concat(t," characters.  The limit is 160."),this.countMessage=""):this.submitted&&!s?(this.messageError="Please enter the text of your message.",this.countMessage=""):e?(this.messageError="",this.countMessage="".concat(s,"/70")):(this.messageError="",this.countMessage="".concat(t,"/160")),this.submitted&&!this.recipients.length?this.groupsError="Please select the recipients of your message.":this.groupsError=null}}},l=c,p=(t("525e"),t("2877")),d=Object(p["a"])(l,r,a,!1,null,null,null);s["default"]=d.exports},"525e":function(e,s,t){"use strict";var r=t("eab0"),a=t.n(r);a.a},a34a:function(e,s,t){e.exports=t("96cf")},eab0:function(e,s,t){}}]);
//# sourceMappingURL=TextsSend.eaaf6f8b.js.map