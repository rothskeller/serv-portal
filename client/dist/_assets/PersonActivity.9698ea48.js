let e=document.createElement("style");e.innerHTML="#person-activity{margin:1.5rem .75rem}#person-activity-month{max-width:18rem}#person-activity-grid{margin-top:1rem;display:grid;grid:auto-flow/minmax(auto,-webkit-max-content) -webkit-max-content;grid:auto-flow/minmax(auto,max-content) max-content;-moz-column-gap:.5rem;column-gap:.5rem;align-items:center}#person-activity-grid.person-activity-editable{row-gap:.5rem}#person-activity-grid.person-activity-with-types{grid:auto-flow/minmax(auto,-webkit-max-content) -webkit-max-content -webkit-max-content;grid:auto-flow/minmax(auto,max-content) max-content max-content}.person-activity-label{margin-left:1rem;text-indent:-1rem}input.person-activity-hours{max-width:5rem}.person-activity-dsw{color:#888}#person-activity-dsw-note{color:#888;margin-right:1rem}#person-activity-total-dsw{display:flex;justify-content:space-between;flex-wrap:wrap-reverse}#person-activity-total-label{font-weight:700;text-align:right}#person-activity-total{font-weight:700;align-self:flex-start}#person-activity-buttons{margin-top:1rem}#person-activity-buttons .sbtn{margin-right:.5rem}#person-activity-guide{margin-top:1.5rem;max-width:800px}#person-activity-guide tr:nth-child(1){background-color:#5b9bd5}#person-activity-guide tr:nth-child(1) td{color:#fff;text-align:center;font-weight:700}#person-activity-guide tr:nth-child(2){font-weight:700}#person-activity-guide tr:nth-child(even){background-color:#deeaf6}#person-activity-guide td{padding:.25rem;width:50%;border:1px solid #eee;vertical-align:top;line-height:1.2}",document.head.appendChild(e);import{d as t,z as i,P as n,Q as a,L as o,F as r,f as s,O as l,n as d,u as c,i as u,S as p,e as v,M as m,C as y,_ as g}from"./index.cd500492.js";import{s as h}from"./page.c0847fc5.js";function f(e){if(!e)return"";const t=Math.floor(e/60).toString();return 30===e?"½ hour":60===e?"1 hour":e%60!=0?`${t}½ hours`:`${t} hours`}const w=t({name:"PersonActivityEvent",props:{event:{type:Object,required:!0},typesColumn:{type:Boolean,required:!0}},setup:e=>(i((()=>e.event),(()=>{e.event.minutes||!e.event.canEdit||e.event.canViewType||(e.event.type=e.event.placeholder?"Volunteer":"Absent")}),{immediate:!0}),function(){const t=`${e.event.placeholder?e.event.date.substr(0,7):e.event.date} ${e.event.name}`;return n(r,[n("div",{class:"person-activity-label"},t),e.typesColumn&&e.event.minutes?n(a,{class:"person-activity-type",value:e.event.placeholder?"Volunteer":e.event.type,disabled:!e.event.canViewType||!e.event.canEdit||e.event.placeholder,onUpdate:t=>e.event.type=t}):e.typesColumn?n("div"):null,e.event.canEdit?n(o,{class:"person-activity-hours",modelValue:(e.event.minutes/60).toString(),type:"number",min:"0",step:"0.5","onUpdate:modelValue":t=>e.event.minutes=60*parseFloat(t)}):n("div",{class:"person-activity-hours"},[f(e.event.minutes),e.event.renewsDSW?n("span",{class:"person-activity-dsw"}," *"):null])])})}),b=t({name:"PersonActivity",props:{onLoadPerson:{type:Function,required:!0}},setup(e){const t=d(),i=c(),a=u("me");h({title:"Volunteer Activity",browserTitle:"Activity"});const o=s(),r=s(!1),m=s(!1);async function f(e){e.preventDefault();const n=new FormData;o.value.events.forEach((e=>{e.canEdit&&n.append(`e${e.id}`,`${e.minutes}:${e.type}`)})),await g.post(`/api/people/${t.params.id}/hours/${t.params.month}`,n),a.value?i.push(`/people/${t.params.id}`):m.value=!0}return l((async()=>{if(t.params.month)if("current"!==t.params.month)try{o.value=(await g.get(`/api/people/${t.params.id}/hours/${t.params.month}`)).data,h({title:o.value.name,browserTitle:"Activity"}),o.value.canHours=!0,e.onLoadPerson(o.value)}catch(e){if(e.response&&403===e.response.status&&!a.value&&i.replace({path:"/login",query:{redirect:t.fullPath}}),!e.response||404!==e.response.status||a.value)throw e;r.value=!0}else{const e=y(),n=e.date()<=10?e.subtract(1,"month"):e;i.replace(`/people/${t.params.id}/activity/${n.format("YYYY-MM")}`)}})),function(){if(r.value)return n("div",{id:"person-activity"},[n("div","The link you used is not valid or has expired."),n("div",{style:"margin-top: 1.5rem"},[n(p,{to:"/login",variant:"primary"},"Go to Login Page")])]);if(m.value)return n("div",{id:"person-activity"},[n("div","Your volunteer hours have been saved. Thank you for volunteering!"),n("div",{style:"margin-top: 1.5rem"},[n(p,{to:"/login",variant:"primary"},"Go to Login Page")])]);if(!o.value)return n("div",{id:"person-activity"},n(v));if(o.value.needsVolgistics&&(!a.value||a.value.id===o.value.id))return n("div",{id:"person-activity-unregistered"},["You are not currently registered as a City of Sunnyvale volunteer. We appreciate your volunteer efforts, but we cannot record your hours until you are registered. To do so, please fill out ",n("a",{href:"https://www.volgistics.com/ex/portal.dll/ap?AP=929478828",target:"_blank"},"this form"),". In the “City employee status or referral” box, please enter",n("pre","Rebecca Elizondo\nDepartment of Public Safety"),"and the names of the organizations you’re volunteering for (CERT, Listos, SARES, and/or SNAP). Come back a week or so later and we should have your registration on file. If you have any difficulties with this, please contact Rebecca at ",n("a",{href:"mailto:RElizondo@sunnyvale.ca.gov"},"RElizondo@sunnyvale.ca.gov"),"."]);const e=o.value.events.some((e=>e.canEdit));return n(e?"form":"div",{id:"person-activity",onSubmit:f},[T(t,i),S(o.value.events),e?x(!!a.value,i):null,e?n("table",{id:"person-activity-guide"},[n("tr",[n("td","Volunteer Hours"),n("td","Not Volunteer Hours")]),n("tr",[n("td","In general, time you spend helping or preparing to help the community as part of SERV. For example:"),n("td","In general, time you spend preparing yourself or your household; or time you spend becoming a SERV volunteer. For example:")]),n("tr",[n("td","Organizing or teaching CERT Basic, Listos, PEP, or SNAP events"),n("td","Attending CERT Basic, Listos, PEP, or ham cram classes")]),n("tr",[n("td","Preparing and maintaining a CERT or SARES “go kit” for deployment"),n("td","Preparing and maintaining a personal or household evacuation kit")]),n("tr",[n("td","SERV team meetings, radio nets, and drills; CERT continuing education seminars; SARES or county ARES training classes"),n("td","SERV team social gatherings")]),n("tr",[n("td","Responding in an emergency when activated by the city"),n("td","Responding in an emergency when not activated by the city")]),n("tr",[n("td","Travel to and from the above"),n("td")]),n("tr",[n("td","SERV administration activities"),n("td")])]):null])}}});function x(e,t){return n("div",{id:"person-activity-buttons"},[n(p,{type:"submit",variant:"primary"},(()=>"Save Activity")),e?n(p,{onClick:function(){t.go(-1)}},(()=>"Cancel")):null])}function E(e){const t=e.reduce(((e,t)=>e+t.minutes),0),i=e.reduce(((e,t)=>e+(t.minutes?1:0)),0),a=e.find((e=>e.renewsDSW&&!e.canEdit)),o=e.some((e=>e.canViewType));return i>1&&a?[n("div",{id:"person-activity-total-dsw"},[n("div",{id:"person-activity-dsw-note"},"* renews DSW registration"),n("div",{id:"person-activity-total-label"},"TOTAL")]),o?n("div"):null,n("div",{id:"person-activity-total"},f(t))]:i>1&&!a?[n("div",{id:"person-activity-total-label"},"TOTAL"),o?n("div"):null,n("div",{style:"person-activity-total"},f(t))]:i<2&&a?n("div",{class:"person-activity-dsw"},"* renews DSW registration"):null}function S(e){if(!e.length)return n("div","No activity has been recorded for this month.");const t=e.some((e=>e.canEdit)),i=e.some((e=>e.canViewType));e.reduce(((e,t)=>e+t.minutes),0);return n("div",{id:"person-activity-grid",class:{"person-activity-editable":t,"person-activity-with-types":i}},[n("div",{style:"font-weight: bold"},"Event"),i?n("div",{style:"font-weight: bold"},"Type"):null,n("div",{style:"font-weight: bold"},"Hours"),e.map((e=>n(w,{event:e,typesColumn:i}))),E(e)])}function T(e,t){return n("div",{id:"person-activity-month"},n(m,{modelValue:e.params.month,"onUpdate:modelValue":i=>{t.replace(`/people/${e.params.id}/activity/${i}`)}}))}export default b;
