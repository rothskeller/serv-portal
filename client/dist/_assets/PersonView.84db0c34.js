let e=document.createElement("style");e.innerHTML=".person-address-label-Mail,.person-address-label-Work{padding-top:0}.person-address-same-box{white-space:nowrap}.person-address-same-label{margin:0 0 0 .5rem}.person-address-input{display:block;width:100%;margin-top:.5rem}.person-address-input:first-child{margin-top:0}.person-view-section{margin-bottom:1.5rem}.person-view-section-header{display:flex;align-items:center;justify-content:space-between;background-color:#eee}.person-view-section-header-text{color:#000;font-size:1.25rem;padding-left:.75rem}.person-view-section-edit{flex:none;padding-left:.25rem;background-color:#fff}#person-view-emails{margin-top:.75rem}.person-view-email-label{color:#888}.person-view-phone{font-variant:tabular-nums}.person-view-phone-label{margin-left:.25rem;color:#888}.person-view-address,.person-view-clearances{margin-top:.75rem;line-height:1.2}.person-view-map{margin-left:1rem}.person-view-map::before{content:'['}.person-view-map::after{content:']'}.person-view-address-flag{color:#888;font-size:.875rem}#person-view-names{display:flex;justify-content:space-between;align-items:flex-start}#person-view-names-ifc{margin-bottom:1.5rem}#person-view-names-ic{font-size:1.25rem;line-height:1.2;color:#000}#person-view-names-i{display:inline;font-weight:700}#person-view-names-c{display:inline;margin-left:.5rem}#person-view-names-f{color:#888;line-height:1}#person-view-names-edit{margin-left:.5rem}#person-edit-note-help{margin:0 .75rem 1rem}.person-edit-note{display:grid;grid:auto-flow/-webkit-min-content 1fr;grid:auto-flow/min-content 1fr;margin:0 .75rem 1rem;-moz-column-gap:1rem;column-gap:1rem}#person-view-notes{margin-top:.75rem}.person-view-note{line-height:1.2;margin-left:2rem;text-indent:-2rem}.person-view-note-date{display:inline;margin-right:.75rem;color:#666;font-variant:tabular-nums}.person-view-note-text{display:inline;margin-left:.5rem}#person-view-roles-badges{display:grid;grid:auto-flow/-webkit-min-content 1fr;grid:auto-flow/min-content 1fr;min-width:0}.person-view-roles-badge{margin-top:1rem}.person-view-roles-titles{margin-top:1rem;line-height:1.2;min-width:0}.person-view-roles-title{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}#person-edbg-header{margin:0 .75rem;border-top:1px solid #ccc;padding-top:.25rem}#person-edbg-help{margin:0 .75rem;color:#6c757d;font-size:80%}#person-view-status-grid{margin-top:.75rem;display:grid;grid:auto-flow/1fr}#person-view-status-grid>div:nth-child(2n+1),#person-view-status-identification div{white-space:nowrap}#person-view-status-grid>div:nth-child(2n){margin-left:2rem}@media (min-width:400px){#person-view-status-grid{grid:auto-flow/-webkit-min-content 1fr;grid:auto-flow/min-content 1fr}#person-view-status-grid>div:nth-child(2n){margin-left:1rem}}#person-view-status-identification{display:flex;flex-wrap:wrap}#person-view-status-identification div::after{content:', '}#person-view-status-identification div:last-child::after{content:''}.person-view-status-date{font-variant-numeric:tabular-nums}.person-view-status-assumed{color:#f60}#person-view-lists-list{margin-top:.75rem;line-height:1.2;margin-left:2em;text-indent:-2em}#person-view{margin:1.5rem .75rem}#person-view-grid{display:grid;grid:auto-flow/1fr}.person-view-spacer{display:none}@media (min-width:740px){#person-view-status-grid{grid:auto-flow/1fr}#person-view-status-grid>div:nth-child(2n){margin-left:2rem}#person-view-grid{grid:auto-flow/1fr 1fr;-moz-column-gap:.75rem;column-gap:.75rem}.person-view-spacer{display:block}}@media (min-width:1048px){#person-view-grid{grid:auto-flow/1fr 1fr 1fr}.person-view-spacer{grid-column:span 2}}#person-view-chpw{display:grid;grid:auto/auto auto;-moz-column-gap:.5rem;column-gap:.5rem;margin-top:.75rem}",document.head.appendChild(e);import{d as n,q as o,j as t,k as s,$ as a,e as r,f as l,i,_ as d,O as u,r as p,c,o as m,w as v,a as h,F as w,h as f,a2 as g,z as y,a3 as b,t as k,G as C,a4 as S,a5 as E,S as A,a6 as x,b as P,m as V,y as R,C as N,g as F,x as T,a7 as M,T as $,I as B,v as D,A as U,s as _,n as H}from"./index.71294f87.js";import{s as I}from"./SubscriptionsForm.8c466813.js";var z=n({components:{Modal:o,SForm:t,SFInput:s,SFPassword:a,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=i("me"),o=l(null);const t=l([]),s=l(!0);const a=l(""),r=l(null),p=l(""),c=l(null),m=l("");const v=l(!1);return{hints:t,loading:s,me:n,modal:o,oldPassword:a,oldPasswordError:function(e,o){return o?!p.value||a.value||n.value.webmaster?a.value&&a.value===m.value?"This is not the correct old password.":"":"You must supply your old password in order to change your password.":""},oldPasswordRef:r,onCancel:function(){o.value.close(!1)},onSubmit:async function(){var n=new FormData;n.append("oldPassword",a.value),n.append("password",p.value),v.value=!0;try{await d.post(`/api/people/${e.pid}/password`,n),o.value.close(!0)}catch(e){if(!e.response||409!==e.response.status)throw e;m.value=a.value}finally{v.value=!1}},password:p,passwordRef:c,show:function(){return a.value=p.value="",async function(){s.value=!0,t.value=(await d.get(`/api/people/${e.pid}/password`)).data,s.value=!1,u((()=>{n.value.webmaster?c.value.focus():r.value.focus()}))}(),o.value.show()},submitting:v}}});z.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("SFInput"),i=p("SFPassword"),d=p("SForm"),u=p("Modal");return m(),c(u,{ref:"modal"},{default:v((()=>[h(d,{dialog:"",variant:"primary",title:"Change Password",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:v((()=>[e.loading?(m(),c(r,{key:0})):(m(),c(w,{key:1},[e.me.webmaster?f("",!0):(m(),c(l,{key:0,id:"person-oldPassword",ref:"oldPasswordRef",type:"password",label:"Old Password",modelValue:e.oldPassword,"onUpdate:modelValue":n[1]||(n[1]=n=>e.oldPassword=n),errorFn:e.oldPasswordError},null,8,["modelValue","errorFn"])),h(i,{id:"person-password",ref:"passwordRef",label:"New Password",modelValue:e.password,"onUpdate:modelValue":n[2]||(n[2]=n=>e.password=n),allowBadPassword:e.me.webmaster,passwordHints:e.hints},null,8,["modelValue","allowBadPassword","passwordHints"])],64))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var q=n({props:{type:String,modelValue:{type:Object,required:!0},hasHome:{type:Boolean,default:!1},help:String},emits:["update:modelValue"],setup(e,{emit:n}){var o;const{modelValue:t}=g(e),s=l(""),a=l(""),r=l(!1);let d="",p=0,c=0;(null==(o=e.modelValue)?void 0:o.address)&&(d=e.modelValue.address,s.value=e.modelValue.address.split(",")[0],a.value=e.modelValue.address.replace(/^[^,]*, */,""),p=e.modelValue.latitude||0,c=e.modelValue.longitude||0),e.modelValue?r.value=e.modelValue.sameAsHome||!1:r.value="Mail"===e.type,y(s,(()=>{""===s.value?a.value="":""===a.value&&(a.value="Sunnyvale, CA")}));const m=l(null);y(r,(()=>{s.value=a.value="",n("update:modelValue",{address:"",latitude:0,longitude:0,sameAsHome:r.value}),r.value||u((()=>{var e;null==(e=m.value)||e.focus()}))}));const v=l(null);const h=l(""),w=i("setValidity");y(h,(()=>{null==w||w(`person-address-${e.type}`,!h.value)}));const{submitted:f}=b();async function k(){if(!s.value&&!a.value)return void n("update:modelValue",{address:"",latitude:0,longitude:0,sameAsHome:r.value});let e=`${s.value}, ${a.value}`;if(e.match(/\W[A-Za-z][A-Za-z]\W/)||(e+=", CA"),e===d)return;const o={address:{regionCode:"US",addressLines:[e]}},t=await fetch("https://addressvalidation.googleapis.com/validateAddress?key=AIzaSyCgi3GzjWG35S89-tnkxHgi5TJVD2eUe2o",{method:"POST",body:JSON.stringify(o)});if(!t||!t.ok)return void(h.value="The address could not be verified because the address verification service is not available.");const l=await t.json();if("SUB_PREMISE"!==l.verdict.validationGranularity&&"PREMISE"!==l.verdict.validationGranularity)d=e,h.value="We couldn't locate this address.  Please provide a valid address.";else{let e=l.address.formattedAddress;s.value=e.split(",")[0],a.value=e.replace(/^[^,]*, */,""),a.value=a.value.replace(/-[0-8]{4}/,""),d=s.value+", "+a.value,p=c=0,l.geocode&&l.geocode.location&&(p=l.geocode.location.latitude,c=l.geocode.location.longitude),n("update:modelValue",{address:d,latitude:p,longitude:c})}}y(f,k);const C="Home"===e.type?"Home Address":"Work"===e.type?"Business Hours Address":"Mailing Address";return{error:h,label:C,line1:s,line1input:m,line2:a,line2input:v,onFocusLine2:function(){var e;null==(e=v.value)||e.select()},onBlur:function(e){e.relatedTarget!==m.value&&e.relatedTarget!==v.value&&k()},sameAsHome:r}}});const L={class:"form-item-input"},O={key:0,class:"person-address-same-box"},W={class:"form-item-help person-address-helpbox"};q.render=function(e,n,o,t,s,a){return m(),c(w,null,[h("label",{class:["form-item-label",`person-address-label-${e.type}`],textContent:k(e.label)},null,10,["textContent"]),h("div",L,["Home"!==e.type?(m(),c("div",O,[C(h("input",{class:"person-address-same",id:`person-address-${e.type}-same`,type:"checkbox",autocomplete:"off","onUpdate:modelValue":n[1]||(n[1]=n=>e.sameAsHome=n),disabled:!e.hasHome},null,8,["id","disabled"]),[[S,e.sameAsHome]]),h("label",{class:"person-address-same-label",for:`person-address-${e.type}-same`},"Same as home address",8,["for"])])):f("",!0),e.sameAsHome?f("",!0):C((m(),c("input",{key:1,class:["form-control person-address-input",{"form-control-invalid":e.error}],ref:"line1input",id:`person-address-${e.type}`,"onUpdate:modelValue":n[2]||(n[2]=n=>e.line1=n),onBlur:n[3]||(n[3]=(...n)=>e.onBlur&&e.onBlur(...n))},null,42,["id"])),[[E,e.line1]]),e.sameAsHome?f("",!0):C((m(),c("input",{key:2,class:["form-control person-address-input",{"form-control-invalid":e.error}],ref:"line2input","onUpdate:modelValue":n[4]||(n[4]=n=>e.line2=n),onFocus:n[5]||(n[5]=(...n)=>e.onFocusLine2&&e.onFocusLine2(...n)),onBlur:n[6]||(n[6]=(...n)=>e.onBlur&&e.onBlur(...n))},null,34)),[[E,e.line2]])]),h("div",W,[e.help?(m(),c("div",{key:0,class:"form-item-help-text",textContent:k(e.help)},null,8,["textContent"])):f("",!0),e.error?(m(),c("div",{key:1,class:"form-item-error-text",textContent:k(e.error)},null,8,["textContent"])):f("",!0)])],64)};var Y=n({components:{Modal:o,PersonEditAddress:q,SForm:t,SFInput:s,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const o=l({}),t=l(!0);const s=l("");const a=l("");const r=l(!1);return{loading:t,modal:n,onCancel:function(){n.value.close(!1)},onSubmit:async function(){var t=new FormData;t.append("email",o.value.email),t.append("email2",o.value.email2),t.append("cellPhone",o.value.cellPhone),t.append("homePhone",o.value.homePhone),t.append("workPhone",o.value.workPhone),o.value.homeAddress.address&&(t.append("homeAddress",o.value.homeAddress.address),t.append("homeAddressLatitude",(o.value.homeAddress.latitude||0).toString()),t.append("homeAddressLongitude",(o.value.homeAddress.longitude||0).toString())),o.value.workAddress.address?(t.append("workAddress",o.value.workAddress.address),t.append("workAddressLatitude",(o.value.workAddress.latitude||0).toString()),t.append("workAddressLongitude",(o.value.workAddress.longitude||0).toString())):t.append("workAddressSameAsHome",o.value.workAddress.sameAsHome.toString()),o.value.mailAddress.address?t.append("mailAddress",o.value.mailAddress.address):t.append("mailAddressSameAsHome",o.value.mailAddress.sameAsHome.toString()),r.value=!0;try{await d.post(`/api/people/${e.pid}/contact`,t),n.value.close(!0)}catch(e){if(!e.response||409!==e.response.status)throw e;switch(e.response.data){case"email":s.value=o.value.email;break;case"cellPhone":a.value=o.value.cellPhone}}finally{r.value=!1}},person:o,show:function(){return async function(){t.value=!0,o.value=(await d.get(`/api/people/${e.pid}/contact`)).data,t.value=!1}(),n.value.show()},submitting:r,emailError:function(e){var n;return e&&(null==(n=o.value)?void 0:n.email)?o.value.email.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/)?s.value===o.value.email?"Another user has this email address.":"":"This is not a valid email address.":""},email2Error:function(e){var n;return e&&(null==(n=o.value)?void 0:n.email2)?o.value.email2.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/)?o.value.email===o.value.email2?"The two email addresses should not be the same.  (Leave this field empty if you only have one.)":"":"This is not a valid email address.":""},cellPhoneError:function(e){var n;return(null==(n=o.value)?void 0:n.cellPhone)?e&&10!==o.value.cellPhone.replace(/[^0-9]/g,"").length?"A valid phone number must have 10 digits.":a.value===o.value.cellPhone?"A different person has this cell phone number.":"":""},homePhoneError:function(e){var n;return e&&(null==(n=o.value)?void 0:n.homePhone)&&10!==o.value.homePhone.replace(/[^0-9]/g,"").length?"A valid phone number must have 10 digits.":""},workPhoneError:function(e){var n;return e&&(null==(n=o.value)?void 0:n.workPhone)&&10!==o.value.workPhone.replace(/[^0-9]/g,"").length?"A valid phone number must have 10 digits.":""}}}});Y.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("SFInput"),i=p("PersonEditAddress"),d=p("SForm"),u=p("Modal");return m(),c(u,{ref:"modal"},{default:v((()=>[h(d,{dialog:"",variant:"primary",title:"Edit Contact Information",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:v((()=>[e.loading?(m(),c(r,{key:0})):(m(),c(w,{key:1},[h(l,{id:"person-email",label:"Email",help:"This is the email address you log in with.",trim:"",autofocus:"",modelValue:e.person.email,"onUpdate:modelValue":n[1]||(n[1]=n=>e.person.email=n),errorFn:e.emailError,style:{"text-transform":"lowercase"}},null,8,["modelValue","errorFn"]),h(l,{id:"person-email2",label:"Alt. Email",trim:"",modelValue:e.person.email2,"onUpdate:modelValue":n[2]||(n[2]=n=>e.person.email2=n),errorFn:e.email2Error,style:{"text-transform":"lowercase"}},null,8,["modelValue","errorFn"]),h(l,{id:"person-cellPhone",label:"Cell Phone",trim:"",modelValue:e.person.cellPhone,"onUpdate:modelValue":n[3]||(n[3]=n=>e.person.cellPhone=n),errorFn:e.cellPhoneError},null,8,["modelValue","errorFn"]),h(l,{id:"person-homePhone",label:"Home Phone",trim:"",modelValue:e.person.homePhone,"onUpdate:modelValue":n[4]||(n[4]=n=>e.person.homePhone=n),errorFn:e.homePhoneError},null,8,["modelValue","errorFn"]),h(l,{id:"person-workPhone",label:"Work Phone",trim:"",modelValue:e.person.workPhone,"onUpdate:modelValue":n[5]||(n[5]=n=>e.person.workPhone=n),errorFn:e.workPhoneError},null,8,["modelValue","errorFn"]),h(i,{type:"Home",modelValue:e.person.homeAddress,"onUpdate:modelValue":n[6]||(n[6]=n=>e.person.homeAddress=n)},null,8,["modelValue"]),h(i,{type:"Work",modelValue:e.person.workAddress,"onUpdate:modelValue":n[7]||(n[7]=n=>e.person.workAddress=n),hasHome:!!e.person.homeAddress.address},null,8,["modelValue","hasHome"]),h(i,{type:"Mail",modelValue:e.person.mailAddress,"onUpdate:modelValue":n[8]||(n[8]=n=>e.person.mailAddress=n),hasHome:!!e.person.homeAddress.address},null,8,["modelValue","hasHome"])],64))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var G=n({components:{SButton:A},props:{title:{type:String,required:!0},editable:{type:Boolean,required:!0}},emits:["edit"]});const Z={class:"person-view-section-header"},j={key:0,class:"person-view-section-edit"},J=P("Edit");G.render=function(e,n,o,t,s,a){const r=p("SButton");return m(),c("div",{class:["person-view-section",{"person-view-section-editable":e.editable}]},[h("div",Z,[h("div",{class:"person-view-section-header-text",textContent:k(e.title)},null,8,["textContent"]),e.editable?(m(),c("div",j,[h(r,{class:"person-view-section-ebtn",variant:"primary",small:"",onClick:n[1]||(n[1]=n=>e.$emit("edit"))},{default:v((()=>[J])),_:1})])):f("",!0)]),x(e.$slots,"default")],2)};var K=n({components:{PersonEditContact:Y,PersonViewSection:G},props:{person:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:n}){const o=V((()=>!!e.person.contact&&(e.person.contact.email||e.person.contact.email2||e.person.contact.cellPhone||e.person.contact.homePhone||e.person.contact.workPhone||e.person.contact.homeAddress||e.person.contact.workAddress||e.person.contact.mailAddress))),t=l(null);return{editContactModal:t,hasContactInfo:o,onEditContact:async function(){await t.value.show()&&n("reload")}}}});const Q={key:0,id:"person-view-emails"},X={key:0},ee={key:1},ne={key:1,class:"person-view-phone"},oe=h("span",{class:"person-view-phone-label"},"(Cell)",-1),te={key:2,class:"person-view-phone"},se=h("span",{class:"person-view-phone-label"},"(Home)",-1),ae={key:3,class:"person-view-phone"},re=h("span",{class:"person-view-phone-label"},"(Work)",-1),le={key:4,class:"person-view-address"},ie={key:0},de={key:1},ue={key:5,class:"person-view-address"},pe=h("span",null,"Work Address:",-1),ce={key:6,class:"person-view-address"},me=h("div",null,"Mailing Address:",-1);K.render=function(e,n,o,t,s,a){const r=p("PersonEditContact"),l=p("PersonViewSection");return e.hasContactInfo||e.person.canEdit?(m(),c(l,{key:0,title:"Contact Information",editable:e.person.canEdit,onEdit:e.onEditContact},{default:v((()=>[e.person.contact.email||e.person.contact.email2?(m(),c("div",Q,[e.person.contact.email?(m(),c("div",X,[h("a",{href:`mailto:${e.person.contact.email}`,textContent:k(e.person.contact.email)},null,8,["href","textContent"])])):f("",!0),e.person.contact.email2?(m(),c("div",ee,[h("a",{href:`mailto:${e.person.contact.email2}`,textContent:k(e.person.contact.email2)},null,8,["href","textContent"])])):f("",!0)])):f("",!0),e.person.contact.cellPhone?(m(),c("div",ne,[h("a",{href:`tel:${e.person.contact.cellPhone}`,textContent:k(e.person.contact.cellPhone)},null,8,["href","textContent"]),oe])):f("",!0),e.person.contact.homePhone?(m(),c("div",te,[h("a",{href:`tel:${e.person.contact.homePhone}`,textContent:k(e.person.contact.homePhone)},null,8,["href","textContent"]),se])):f("",!0),e.person.contact.workPhone?(m(),c("div",ae,[h("a",{href:`tel:${e.person.contact.workPhone}`,textContent:k(e.person.contact.workPhone)},null,8,["href","textContent"]),re])):f("",!0),e.person.contact.homeAddress&&e.person.contact.homeAddress.address?(m(),c("div",le,[h("div",null,[e.person.contact.workAddress&&e.person.contact.workAddress.sameAsHome?(m(),c("span",ie,"Home Address (all day):")):(m(),c("span",de,"Home Address:")),h("a",{class:"person-view-map",target:"_blank",href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.person.contact.homeAddress.address)}`},"Map",8,["href"])]),h("div",{textContent:k(e.person.contact.homeAddress.address.split(",")[0])},null,8,["textContent"]),h("div",{textContent:k(e.person.contact.homeAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"]),e.person.contact.homeAddress.fireDistrict?(m(),c("div",{key:0,textContent:k(`Sunnyvale Fire District ${e.person.contact.homeAddress.fireDistrict}`)},null,8,["textContent"])):f("",!0)])):f("",!0),e.person.contact.workAddress&&e.person.contact.workAddress.address?(m(),c("div",ue,[h("div",null,[pe,h("a",{class:"person-view-map",target:"_blank",href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.person.contact.workAddress.address)}`},"Map",8,["href"])]),h("div",{textContent:k(e.person.contact.workAddress.address.split(",")[0])},null,8,["textContent"]),h("div",{textContent:k(e.person.contact.workAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"]),e.person.contact.workAddress.fireDistrict?(m(),c("div",{key:0,textContent:k(`Sunnyvale Fire District ${e.person.contact.workAddress.fireDistrict}`)},null,8,["textContent"])):f("",!0)])):f("",!0),e.person.contact.mailAddress&&e.person.contact.mailAddress.address?(m(),c("div",ce,[me,h("div",{textContent:k(e.person.contact.mailAddress.address.split(",")[0])},null,8,["textContent"]),h("div",{textContent:k(e.person.contact.mailAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"])])):f("",!0),e.person.canEdit?(m(),c(r,{key:7,ref:"editContactModal",pid:e.person.id},null,8,["pid"])):f("",!0)])),_:1},8,["editable","onEdit"])):f("",!0)};var ve=n({components:{Modal:o,SForm:t,SFInput:s,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const o=l({}),t=l(!0);const s=l(""),a=l("");function r(e){if(!e)return e;const n=e.split(/\s+/,2);return n.length>1?`${n[1]}, ${n[0]}`:e}y((()=>o.value.informalName),((e,n)=>{o.value.formalName===n&&(o.value.formalName=e),o.value.sortName===r(n)&&(o.value.sortName=r(e))}));const i=l(!1);return{callSignError:function(e){var n;return o.value.callSign?e&&!o.value.callSign.match(/^[AKNW][A-Z]?[0-9][A-Z]{1,3}$/i)?"This is not a valid call sign.":s.value===(null==(n=o.value)?void 0:n.callSign)?"A different person has this call sign.":"":""},formalNameError:function(e){return e?o.value.formalName?"":"A name is required.":""},informalNameError:function(e){return e?o.value.informalName?"":"A name is required.":""},loading:t,modal:n,onCancel:function(){n.value.close(!1)},onSubmit:async function(){var t=new FormData;t.append("informalName",o.value.informalName),t.append("formalName",o.value.formalName),t.append("sortName",o.value.sortName),t.append("callSign",o.value.callSign),i.value=!0;try{await d.post(`/api/people/${e.pid}/names`,t),n.value.close(!0)}catch(e){if(!e.response||409!==e.response.status)throw e;switch(e.response.data){case"sortName":a.value=o.value.sortName;break;case"callSign":s.value=o.value.callSign}}finally{i.value=!1}},person:o,show:function(){return async function(){t.value=!0,o.value=(await d.get(`/api/people/${e.pid}/names`)).data,t.value=!1}(),n.value.show()},sortNameError:function(e){var n;return o.value.sortName?a.value===(null==(n=o.value)?void 0:n.sortName)?"A different person has this name.":"":e?"A name is required.":""},submitting:i}}});ve.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("SFInput"),i=p("SForm"),d=p("Modal");return m(),c(d,{ref:"modal"},{default:v((()=>[h(i,{dialog:"",variant:"primary",title:"Edit Names",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:v((()=>[e.loading?(m(),c(r,{key:0})):(m(),c(w,{key:1},[h(l,{id:"person-informalName",label:"Name",trim:"",autofocus:"",modelValue:e.person.informalName,"onUpdate:modelValue":n[1]||(n[1]=n=>e.person.informalName=n),errorFn:e.informalNameError,help:"What you like to be called, e.g. “Joe Banks”"},null,8,["modelValue","errorFn"]),h(l,{id:"person-formalName",label:"Formal name",trim:"",modelValue:e.person.formalName,"onUpdate:modelValue":n[2]||(n[2]=n=>e.person.formalName=n),errorFn:e.formalNameError,help:"For formal documents, e.g. “Joseph A. Banks, Jr.”"},null,8,["modelValue","errorFn"]),h(l,{id:"person-sortName",label:"Sort name",trim:"",modelValue:e.person.sortName,"onUpdate:modelValue":n[3]||(n[3]=n=>e.person.sortName=n),errorFn:e.sortNameError,help:"For appearance in sorted lists, e.g. “Banks, Joe”"},null,8,["modelValue","errorFn"]),h(l,{id:"person-callSign",label:"Call sign",trim:"",modelValue:e.person.callSign,"onUpdate:modelValue":n[4]||(n[4]=n=>e.person.callSign=n),errorFn:e.callSignError,help:"FCC amateur radio license",style:{"text-transform":"uppercase"}},null,8,["modelValue","errorFn"])],64))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var he=n({components:{PersonEditNames:ve,SButton:A},props:{person:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:n}){const o=l(null);return{editNamesModal:o,onEditNames:async function(){await o.value.show()&&n("reload")}}}});const we={id:"person-view-names"},fe={id:"person-view-names-ifc"},ge={id:"person-view-names-ic"},ye={key:0,id:"person-view-names-edit"},be=P("Edit");he.render=function(e,n,o,t,s,a){const r=p("SButton"),l=p("PersonEditNames");return m(),c("div",we,[h("div",fe,[h("div",ge,[h("div",{id:"person-view-names-i",textContent:k(e.person.informalName)},null,8,["textContent"]),e.person.callSign?(m(),c("div",{key:0,id:"person-view-names-c",textContent:k(e.person.callSign)},null,8,["textContent"])):f("",!0)]),e.person.formalName!==e.person.informalName?(m(),c("div",{key:0,id:"person-view-names-f",textContent:k(`(${e.person.formalName})`)},null,8,["textContent"])):f("",!0)]),e.person.canEdit?(m(),c("div",ye,[h(r,{variant:"primary",small:"",onClick:e.onEditNames},{default:v((()=>[be])),_:1},8,["onClick"])])):f("",!0),e.person.canEdit?(m(),c(l,{key:1,ref:"editNamesModal",pid:e.person.id},null,8,["pid"])):f("",!0)])};const ke={webmaster:"Webmasters only",admin:"DPS staff only",leader:"SERV leads only",contact:"Anyone who can see contact info",person:"Anyone"};let Ce=[{value:"webmaster",label:"Webmasters only"},{value:"admin",label:"DPS staff only"},{value:"leader",label:"SERV leads only"},{value:"contact",label:"Anyone who can see contact info"},{value:"person",label:"Anyone"}];var Se=n({components:{Modal:o,SButton:A,SForm:t,SFInput:s,SFSelect:R,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const o=l([]),t=l([]),s=l({}),a=l(!0);const r=l(null);const i=l(!1);return{editNote:function(e){s.value.date&&s.value.note&&o.value.push(s.value),t.value.forEach((e=>o.value.push(e)));const n=o.value.findIndex((n=>n===e));t.value=o.value.splice(n+1),s.value=o.value.splice(n,1)[0],u((()=>{r.value.focus()}))},loading:a,modal:n,noteEditing:s,noteRef:r,notesAfter:t,notesBefore:o,onAdd:function(){s.value.date&&s.value.note&&o.value.push(s.value),t.value.forEach((e=>o.value.push(e))),t.value=[],s.value={date:N().format("YYYY-MM-DD"),note:"",visibility:Ce[0].value},u((()=>{r.value.focus()}))},onCancel:function(){n.value.close(!1)},onSubmit:async function(){var a=new FormData;o.value.forEach((e=>{a.append("note",e.note),a.append("date",e.date),a.append("visibility",e.visibility)})),s.value.date&&s.value.note&&(a.append("note",s.value.note),a.append("date",s.value.date),a.append("visibility",s.value.visibility)),t.value.forEach((e=>{a.append("note",e.note),a.append("date",e.date),a.append("visibility",e.visibility)})),i.value=!0,await d.post(`/api/people/${e.pid}/notes`,a),i.value=!1,n.value.close(!0)},show:function(){return async function(){a.value=!0;const n=(await d.get(`/api/people/${e.pid}/notes`)).data;o.value=n.notes,o.value.sort(((e,n)=>e.date!==n.date?e.date<n.date?-1:1:e.note.localeCompare(n.note))),t.value=[],Ce=Ce.filter((e=>n.visibilities.includes(e.value))),o.value.length?s.value={date:"",note:"",visibility:""}:s.value={date:N().format("YYYY-MM-DD"),note:"",visibility:Ce[0].value};a.value=!1}(),n.value.show()},submitting:i,visibilityLabels:ke,visibilityOptions:Ce}}});const Ee={key:0,class:"form-item",id:"person-edit-note-help"},Ae=h("div",null,"Date",-1),xe=h("div",null,"Note",-1),Pe=h("div",null,"Vis.",-1),Ve=h("div",null,"Date",-1),Re=h("div",null,"Note",-1),Ne=h("div",null,"Vis.",-1),Fe=P("Add");Se.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("SFInput"),i=p("SFSelect"),d=p("SButton"),u=p("SForm"),g=p("Modal");return m(),c(g,{ref:"modal"},{default:v((()=>[h(u,{dialog:"",variant:"primary",title:"Edit Notes",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{extraButtons:v((()=>[h(d,{variant:"primary",onClick:e.onAdd},{default:v((()=>[Fe])),_:1},8,["onClick"])])),default:v((()=>[e.loading?(m(),c(r,{key:0})):(m(),c(w,{key:1},[e.notesBefore.length||e.notesAfter.length?(m(),c("div",Ee,"Click on a note to edit it, or click the Add button to add one.")):f("",!0),(m(!0),c(w,null,F(e.notesBefore,(n=>(m(),c("div",{class:"person-edit-note form-item",onClick:o=>e.editNote(n)},[Ae,h("div",{textContent:k(n.date)},null,8,["textContent"]),xe,h("div",{textContent:k(n.note)},null,8,["textContent"]),Pe,h("div",{textContent:k(e.visibilityLabels[n.visibility])},null,8,["textContent"])],8,["onClick"])))),256)),e.noteEditing.date?(m(),c(w,{key:1},[h(l,{id:"person-edit-note-date",label:"Date",type:"date",modelValue:e.noteEditing.date,"onUpdate:modelValue":n[1]||(n[1]=n=>e.noteEditing.date=n)},null,8,["modelValue"]),h(l,{id:"person-edit-note-note",ref:"noteRef",label:"Note Text",trim:"",modelValue:e.noteEditing.note,"onUpdate:modelValue":n[2]||(n[2]=n=>e.noteEditing.note=n)},null,8,["modelValue"]),h(i,{id:"person-edit-note-visibility",label:"Visibility",options:e.visibilityOptions,modelValue:e.noteEditing.visibility,"onUpdate:modelValue":n[3]||(n[3]=n=>e.noteEditing.visibility=n)},null,8,["options","modelValue"])],64)):f("",!0),(m(!0),c(w,null,F(e.notesAfter,(n=>(m(),c("div",{class:"person-edit-note form-item",onClick:o=>e.editNote(n)},[Ve,h("div",{textContent:k(n.date)},null,8,["textContent"]),Re,h("div",{textContent:k(n.note)},null,8,["textContent"]),Ne,h("div",{textContent:k(e.visibilityLabels[n.visibility])},null,8,["textContent"])],8,["onClick"])))),256))],64))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var Te=n({components:{PersonEditNotes:Se,PersonViewSection:G},props:{person:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:n}){const o=l(null);return{editNotesModal:o,onEditNotes:async function(){await o.value.show()&&n("reload")}}}});const Me={id:"person-view-notes"},$e={class:"person-view-note"},Be={key:0};Te.render=function(e,n,o,t,s,a){const r=p("PersonEditNotes"),l=p("PersonViewSection");return e.person.notes.length||e.person.canEditNotes?(m(),c(l,{key:0,title:"Notes",editable:e.person.canEditNotes,onEdit:e.onEditNotes},{default:v((()=>[h("div",Me,[(m(!0),c(w,null,F(e.person.notes,(e=>(m(),c("div",$e,[h("div",{class:"person-view-note-date",textContent:k(e.date)},null,8,["textContent"]),h("div",{class:"person-view-note-text",textContent:k(e.note)},null,8,["textContent"])])))),256)),e.person.notes.length?f("",!0):(m(),c("div",Be,"No notes on file."))]),e.person.canEdit?(m(),c(r,{key:0,ref:"editNotesModal",pid:e.person.id},null,8,["pid"])):f("",!0)])),_:1},8,["editable","onEdit"])):f("",!0)};const De={admin:"Admin","cert-d":"CERT Deployment","cert-t":"CERT Training",listos:"Listos",sares:"SARES",snap:"SNAP"};var Ue=n({components:{Modal:o,SFCheckGroup:T,SForm:t,SFSelect:R,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const o=l([]),t=l("");const s=l([]),a=l(new Set);y(t,(()=>{if(!o.value.length)return;const e=o.value.find((e=>e.org===t.value)).roles;a.value=new Set(e.filter((e=>e.held)).map((e=>e.id)))})),y([a,t],((e,n)=>{if(!o.value.length)return;let r=e[1]!=n[1];if(e[0].forEach((e=>{n[0].has(e)||(r=!0)})),n[0].forEach((n=>{e[0].has(n)||(r=!0)})),!r)return;const l=new Set,i=new Set;o.value.forEach((e=>{e.org===t.value?e.roles.filter((e=>(!e.held||e.direct)&&a.value.has(e.id))).forEach((e=>{l.add(e.id),e.implies.forEach((e=>i.add(e)))})):e.roles.filter((e=>e.held&&e.direct)).forEach((e=>{l.add(e.id),e.implies.forEach((e=>i.add(e)))}))})),o.value.forEach((e=>{e.roles.forEach((e=>{l.has(e.id)?e.held=e.direct=!0:i.has(e.id)?(e.held=!0,e.direct=!1):e.held=e.direct=!1}))}));const d=o.value.find((e=>e.org===t.value)).roles;a.value=new Set(d.filter((e=>e.held)).map((e=>e.id))),s.value=d.map((e=>({value:e.id,label:e.name,disabled:e.implicitOnly||e.held&&!e.direct})))}));const r=l(!1);return{modal:n,onCancel:function(){n.value.close(!1)},onSubmit:async function(){var t=new FormData;o.value.forEach((e=>{e.roles.filter((e=>e.held&&e.direct)).forEach((e=>{t.append("role",e.id.toString())}))})),r.value=!0,await d.post(`/api/people/${e.pid}/roles`,t),r.value=!1,n.value.close(!0)},org:t,orgRoleOptions:s,orgRoles:a,orgs:o,show:function(){return async function(){o.value=[],t.value="",o.value=(await d.get(`/api/people/${e.pid}/roles`)).data,o.value.forEach((e=>{e.fmtOrg=De[e.org]})),t.value=o.value[0].org}(),n.value.show()},submitting:r}}});function _e(e){return"admin"===e.org&&e.title.startsWith("OES")?"dps":"admin"===e.org?"serv":e.org.replace(/-.*/,"")}Ue.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("SFSelect"),i=p("SFCheckGroup"),d=p("SForm"),u=p("Modal");return m(),c(u,{ref:"modal"},{default:v((()=>[h(d,{dialog:"",variant:"primary",title:"Edit Roles",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:v((()=>[e.orgs.length?(m(),c(w,{key:1},[e.orgs.length>1?(m(),c(l,{key:0,id:"person-roles-org",label:"Org",options:e.orgs,valueKey:"org",labelKey:"fmtOrg",modelValue:e.org,"onUpdate:modelValue":n[1]||(n[1]=n=>e.org=n)},null,8,["options","modelValue"])):f("",!0),h(i,{id:"person-roles-roles",label:e.orgs.length>1?"Roles":"",options:e.orgRoleOptions,disabledKey:"disabled",modelValue:e.orgRoles,"onUpdate:modelValue":n[2]||(n[2]=n=>e.orgRoles=n)},null,8,["label","options","modelValue"])],64)):(m(),c(r,{key:0}))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var He=n({components:{OrgBadge:M,PersonEditRoles:Ue,PersonViewSection:G},props:{person:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:n}){const o=l([]);$((()=>{o.value=[],e.person.roles.forEach((e=>{const n=o.value.findIndex((n=>n.org===_e(e)));n<0?o.value.push({org:_e(e),titles:[e.title]}):o.value[n].titles.push(e.title)}))}));const t=l(null);return{editRolesModal:t,onEditRoles:async function(){await t.value.show()&&n("reload")},badges:o}}});const Ie={id:"person-view-roles-badges"},ze={class:"person-view-roles-titles"},qe={key:0,class:"person-view-roles-title"};He.render=function(e,n,o,t,s,a){const r=p("OrgBadge"),l=p("PersonEditRoles"),i=p("PersonViewSection");return e.badges.length||e.person.canEditRoles?(m(),c(i,{key:0,title:"SERV "+(1===e.person.roles.length?"Role":"Roles"),editable:e.person.canEditRoles,onEdit:e.onEditRoles},{default:v((()=>[h("div",Ie,[(m(!0),c(w,null,F(e.badges,(e=>(m(),c(w,null,[h(r,{class:"person-view-roles-badge",org:e.org},null,8,["org"]),h("div",ze,[(m(!0),c(w,null,F(e.titles,(e=>(m(),c("div",{class:"person-view-roles-title",textContent:k(e)},null,8,["textContent"])))),256))])],64)))),256)),e.badges.length?f("",!0):(m(),c("div",qe,"No current role in any SERV org."))]),e.person.canEditRoles?(m(),c(l,{key:0,ref:"editRolesModal",pid:e.person.id},null,8,["pid"])):f("",!0)])),_:1},8,["title","editable","onEdit"])):f("",!0)};const Le=n({name:"PersonEditBGChecks",props:{checks:{type:Array,required:!0},types:{type:Array,required:!0}},setup(e,{expose:n}){const o=l([...e.checks]),t=l([]),s=l({date:"",types:new Set,assumed:!1}),a=l(0===e.checks.length);function r(){return!a.value||!(s.value.date&&!s.value.date.match(/^20\d\d-\d\d-\d\d$/))&&(s.value.types.size&&o.value.push({date:s.value.date,types:e.types.filter((e=>s.value.types.has(e))),assumed:s.value.assumed}),o.value.splice(o.value.length,0,...t.value.splice(0)),o.value.sort(((e,n)=>e.date.localeCompare(n.date))),a.value=!1,!0)}function i(e){if(!r())return;s.value.date=e.date,s.value.types=new Set(e.types),s.value.assumed=e.assumed;const n=o.value.findIndex((n=>n===e));t.value.splice(t.value.length,0,...o.value.splice(n+1)),o.value.splice(n),a.value=!0}return n({startAdd:function(){console.log("startAdd called"),r()&&(s.value.date=N().format("YYYY-MM-DD"),s.value.types=new Set,s.value.assumed=!1,a.value=!0)},prepareForSave:function(){r(),e.checks.splice(0,e.checks.length,...o.value)}}),function(){return[(n=e.checks,[B("div",{id:"person-edbg-header",class:"form-item"},"Background Checks"),n.length?B("div",{id:"person-edbg-help",class:"form-item"},"Click on a check to edit it, or click Add to add one."):null]),Oe(o.value,i),a.value?We(s.value,e.types):null,Oe(t.value,i)];var n}}});function Oe(e,n){return e.map((e=>B("div",{class:"form-item-input",onClick:()=>{n(e)}},`${e.date||"Unknown date"}: ${e.types.join(", ")}${e.assumed?" (assumed)":""}`)))}function We(e,n){return[B(s,{id:"person-edbg-date",label:"Date",help:"Date on which the background check was cleared (empty if not known)",type:"date",modelValue:e.date,"onUpdate:modelValue":n=>e.date=n,errorFn:n=>n&&""!==e.date?e.date.match(/^20\d\d-\d\d-\d\d$/)?"":"This is not a valid date.":""}),B(T,{id:"person-edbg-types",label:"Type(s)",options:n,inline:!0,modelValue:e.types,"onUpdate:modelValue":n=>e.types=n}),B(D,{id:"person-edbg-assumed",label:"Assumed (no paper record)",help:"Checks are assumed for long-standing volunteers whose historical records are missing.",modelValue:e.assumed,"onUpdate:modelValue":n=>e.assumed=n})]}function Ye(e){return e.replace(/[^0-9]/g,"")}var Ge=n({components:{Modal:o,PersonEditBGChecks:Le,SButton:A,SForm:t,SFCheckGroup:T,SFInput:s,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const o=l({}),t=l(""),s=l(new Set),a=l([]),r=l(!0);const i=l(null);const u=l(!1);return{bgChecksRef:i,digitsOnly:Ye,dswCERTError:function(e){return e&&o.value.dswCERT?o.value.dswCERT.match(/^20\d\d-\d\d-\d\d$/)?"":"This is not a valid YYYY-MM-DD date.":""},dswCommError:function(e){return e&&o.value.dswComm?o.value.dswComm.match(/^20\d\d-\d\d-\d\d$/)?"":"This is not a valid YYYY-MM-DD date.":""},identification:s,identTypes:a,loading:r,modal:n,onAddBGCheck:function(){var e;console.log("onAddBGCheck called"),null==(e=i.value)||e.startAdd()},onCancel:function(){n.value.close(!1)},onSubmit:async function(){var a;null==(a=i.value)||a.prepareForSave();var r=new FormData;r.append("volgistics",t.value),r.append("dswCERT",o.value.dswCERT||""),r.append("dswComm",o.value.dswComm||""),s.value.forEach((e=>{r.append("identification",e)})),o.value.bgChecks.forEach((e=>{r.append("bgCheck",`${e.date}:${e.types.join(",")}:${e.assumed}`)})),u.value=!0,await d.post(`/api/people/${e.pid}/status`,r),u.value=!1,n.value.close(!0)},person:o,show:function(){return async function(){r.value=!0,o.value=(await d.get(`/api/people/${e.pid}/status`)).data,t.value=o.value.volgistics?o.value.volgistics.toString():"",a.value=o.value.identification.map((e=>({label:e.type,value:e.type}))),s.value=new Set(o.value.identification.filter((e=>e.held)).map((e=>e.type))),r.value=!1}(),n.value.show()},submitting:u,volgistics:t,volgisticsError:function(e){return e&&t.value&&parseInt(t.value)<1?"This is not a valid Volgistics ID number.":""}}}});const Ze=P("Add");Ge.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("SFInput"),i=p("SFCheckGroup"),d=p("PersonEditBGChecks"),u=p("SButton"),f=p("SForm"),g=p("Modal");return m(),c(g,{ref:"modal"},{default:v((()=>[h(f,{dialog:"",variant:"primary",title:"Edit Volunteer Status",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{extraButtons:v((()=>[h(u,{variant:"primary",onClick:U(e.onAddBGCheck,["prevent"])},{default:v((()=>[Ze])),_:1},8,["onClick"])])),default:v((()=>[e.loading?(m(),c(r,{key:0})):(m(),c(w,{key:1},[h(l,{id:"person-volgistics",label:"Volgistics ID",modelValue:e.volgistics,"onUpdate:modelValue":n[1]||(n[1]=n=>e.volgistics=n),autofocus:"",errorFn:e.volgisticsError,restrictFn:e.digitsOnly},null,8,["modelValue","errorFn","restrictFn"]),h(l,{id:"person-dsw-cert",type:"date",label:"DSW CERT",modelValue:e.person.dswCERT,"onUpdate:modelValue":n[2]||(n[2]=n=>e.person.dswCERT=n),errorFn:e.dswCERTError,help:"Date when CERT DSW registration form was signed."},null,8,["modelValue","errorFn","help"]),h(l,{id:"person-dsw-comm",type:"date",label:"DSW Communications",modelValue:e.person.dswComm,"onUpdate:modelValue":n[3]||(n[3]=n=>e.person.dswComm=n),errorFn:e.dswCommError,help:"Date when Communications DSW registration form was signed."},null,8,["modelValue","errorFn","help"]),h(i,{id:"person-identification",label:"IDs Issued",modelValue:e.identification,"onUpdate:modelValue":n[4]||(n[4]=n=>e.identification=n),options:e.identTypes},null,8,["modelValue","options"]),h(d,{ref:"bgChecksRef",checks:e.person.bgChecks,types:e.person.bgCheckTypes},null,8,["checks","types"])],64))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var je=n({components:{PersonEditStatus:Ge,PersonViewSection:G},props:{person:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:n}){const o=i("me"),t=V((()=>e.person.status&&!e.person.status.dswCERT.registered&&!e.person.status.dswCERT.needed&&!e.person.status.dswComm.registered&&!e.person.status.dswComm.needed&&(e.person.status.backgroundCheck.admin?!e.person.status.backgroundCheck.needed&&!e.person.status.backgroundCheck.checks.length:!e.person.status.backgroundCheck.cleared&&!e.person.status.backgroundCheck.needed)&&!e.person.status.identification.length)),s=V((()=>!(!(e.person.status&&e.person.status.backgroundCheck.admin&&e.person.status.backgroundCheck.needed)||e.person.status.backgroundCheck.checks.find((n=>n.type.indexOf(e.person.status.backgroundCheck.needed)>=0)))&&e.person.status.backgroundCheck.needed)),a=l(null);return{editStatusModal:a,onEditStatus:async function(){await a.value.show()&&n("reload")},me:o,missingBGCheck:s,nothingElseToShow:t}}});const Je={id:"person-view-status-grid"},Ke=h("div",null,"Volgistics",-1),Qe=h("div",null,"City volunteer",-1),Xe={key:0},en=h("a",{href:"https://www.volgistics.com/ex/portal.dll/ap?AP=929478828",target:"_blank"},"Please register",-1),nn={key:1,style:{color:"red"}},on={key:0},tn={key:1},sn=h("div",null,"DSW CERT",-1),an={key:1},rn={key:2},ln={key:3},dn={key:4},un=h("div",null,"DSW CERT",-1),pn=h("div",{style:{color:"red"}},"Not registered",-1),cn=h("div",null,"DSW SARES",-1),mn={key:1},vn={key:2},hn={key:3},wn={key:4},fn=h("div",null,"DSW SARES",-1),gn=h("div",{style:{color:"red"}},"Not registered",-1),yn=h("div",null,"Background Checks",-1),bn={id:"person-view-status-checks"},kn={key:0,style:{color:"red"}},Cn=h("div",null,"Background check",-1),Sn=h("div",null,"Cleared",-1),En=h("div",null,"Background check",-1),An=h("div",null,"Background check",-1),xn=h("div",{style:{color:"red"}},"Not cleared",-1),Pn=h("div",null,"IDs issued",-1),Vn={id:"person-view-status-identification"};je.render=function(e,n,o,t,s,a){const r=p("PersonEditStatus"),l=p("PersonViewSection");return e.person.status?(m(),c(l,{key:0,title:"Volunteer Status",editable:e.person.status.canEdit,onEdit:e.onEditStatus},{default:v((()=>[h("div",Je,["admin"===e.person.status.level?(m(),c(w,{key:0},[Ke,e.person.status.volgistics.id?(m(),c("div",{key:0,textContent:k(`#${e.person.status.volgistics.id}`)},null,8,["textContent"])):(m(),c("div",{key:1,style:{color:e.person.status.volgistics.needed?"red":null}},"Not registered",4))],64)):e.person.status.volgistics.needed&&!e.person.status.volgistics.id?(m(),c(w,{key:1},[Qe,e.me.id===e.person.id?(m(),c("div",Xe,[en])):(m(),c("div",nn,"Not registered"))],64)):e.nothingElseToShow?(m(),c(w,{key:2},[e.person.status.volgistics.id?(m(),c("div",on,"Registered")):(m(),c("div",tn,"Not registered"))],64)):f("",!0),e.person.status.dswCERT.registered?(m(),c(w,{key:3},[sn,e.person.status.dswCERT.expired?(m(),c("div",{key:0,style:{color:e.person.status.dswCERT.needed?"red":null}},"Expired on "+k(e.person.status.dswCERT.expires),5)):"admin"==e.person.status.level&&e.person.status.dswCERT.expires?(m(),c("div",an,"Registered "+k(e.person.status.dswCERT.registered)+", expires "+k(e.person.status.dswCERT.expires.replace(/-/g,"‑")),1)):"admin"==e.person.status.level?(m(),c("div",rn,"Registered "+k(e.person.status.dswCERT.registered),1)):e.person.status.dswCERT.expires?(m(),c("div",ln,"Expires on "+k(e.person.status.dswCERT.expires),1)):(m(),c("div",dn,"Registered"))],64)):e.person.status.dswCERT.needed?(m(),c(w,{key:4},[un,pn],64)):f("",!0),e.person.status.dswComm.registered?(m(),c(w,{key:5},[cn,e.person.status.dswComm.expired?(m(),c("div",{key:0,style:{color:e.person.status.dswComm.needed?"red":null}},"Expired on "+k(e.person.status.dswComm.expires),5)):"admin"==e.person.status.level&&e.person.status.dswComm.expires?(m(),c("div",mn,"Registered "+k(e.person.status.dswComm.registered)+", expires "+k(e.person.status.dswComm.expires.replace(/-/g,"‑")),1)):"admin"==e.person.status.level?(m(),c("div",vn,"Registered "+k(e.person.status.dswComm.registered),1)):e.person.status.dswComm.expires?(m(),c("div",hn,"Expires on "+k(e.person.status.dswComm.expires),1)):(m(),c("div",wn,"Registered"))],64)):e.person.status.dswComm.needed?(m(),c(w,{key:6},[fn,gn],64)):f("",!0),e.person.status.backgroundCheck.admin?(m(),c(w,{key:7},[yn,h("div",bn,[(m(!0),c(w,null,F(e.person.status.backgroundCheck.checks,(e=>(m(),c("div",{class:{"person-view-status-assumed":e.assumed}},[e.date?(m(),c("span",{key:0,class:"person-view-status-date",textContent:k(`${e.date} `)},null,8,["textContent"])):f("",!0),h("span",{textContent:k(e.type.join("+"))},null,8,["textContent"]),e.assumed?(m(),c("span",{key:1,textContent:k(" (assumed)")},null,8,["textContent"])):e.date?f("",!0):(m(),c("span",{key:2,textContent:k(" (date unknown)")},null,8,["textContent"]))],2)))),256)),e.missingBGCheck?(m(),c("div",kn,"Missing required "+k(e.missingBGCheck)+" check",1)):f("",!0)])],64)):(m(),c(w,{key:8},["true"===e.person.status.backgroundCheck.cleared?(m(),c(w,{key:0},[Cn,Sn],64)):e.person.status.backgroundCheck.cleared?(m(),c(w,{key:1},[En,h("div",null,"Cleared on "+k(e.person.status.backgroundCheck.cleared),1)],64)):e.person.status.backgroundCheck.needed?(m(),c(w,{key:2},[An,xn],64)):f("",!0)],64)),e.person.status.identification.length?(m(),c(w,{key:9},[Pn,h("div",Vn,[(m(!0),c(w,null,F(e.person.status.identification,(e=>(m(),c("div",{textContent:k(e)},null,8,["textContent"])))),256))])],64)):f("",!0)]),e.person.canEdit?(m(),c(r,{key:0,ref:"editStatusModal",pid:e.person.id},null,8,["pid"])):f("",!0)])),_:1},8,["editable","onEdit"])):f("",!0)};var Rn=n({components:{Modal:o,SubscriptionsForm:I},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);return{modal:n,onDone:function(e){n.value.close(e)},show:function(){return n.value.show()}}}});Rn.render=function(e,n,o,t,s,a){const r=p("SubscriptionsForm"),l=p("Modal");return m(),c(l,{ref:"modal"},{default:v((()=>[h(r,{inModal:"",pid:e.pid,onDone:e.onDone},null,8,["pid","onDone"])])),_:1},512)};var Nn=n({components:{PersonEditSubscriptions:Rn,PersonViewSection:G},props:{person:{type:Object,required:!0}},emits:["reload"],setup(e,{emit:n}){const o=l(null);return{editSubscriptionsModal:o,onEditSubscriptions:async function(){await o.value.show()&&n("reload")}}}});const Fn={id:"person-view-lists-list"},Tn={key:0,style:{color:"red"}},Mn={key:1,style:{color:"red"}};Nn.render=function(e,n,o,t,s,a){const r=p("PersonEditSubscriptions"),l=p("PersonViewSection");return e.person.noEmail||e.person.noText||e.person.lists.length||e.person.canEditLists?(m(),c(l,{key:0,title:"Subscriptions",editable:e.person.canEditLists,onEdit:e.onEditSubscriptions},{default:v((()=>[h("div",Fn,[e.person.noEmail?(m(),c("div",Tn,"Unsubcribed from all email.")):f("",!0),e.person.noText?(m(),c("div",Mn,"Unsubscribed from all text messaging.")):f("",!0),(m(!0),c(w,null,F(e.person.lists,(e=>(m(),c("div",{textContent:k(e)},null,8,["textContent"])))),256))]),e.person.canEditLists?(m(),c(r,{key:0,ref:"editSubscriptionsModal",pid:e.person.id},null,8,["pid"])):f("",!0)])),_:1},8,["editable","onEdit"])):f("",!0)};var $n=n({components:{MessageBox:_,PersonEditPassword:z,PersonViewContact:K,PersonViewNames:he,PersonViewNotes:Te,PersonViewRoles:He,PersonViewSection:G,PersonViewStatus:je,PersonViewSubscriptions:Nn,SButton:A,SSpinner:r},props:{onLoadPerson:{type:Function,required:!0}},setup(e){const n=H(),o=l(null);d.get(`/api/people/${n.params.id}`).then((n=>{o.value=n.data,e.onLoadPerson(o.value)}));const t=l(null);const s=l(null);return{changePasswordModal:t,onChangePassword:function(){t.value.show()},onResetPassword:function(){s.value.show()&&d.post(`/api/people/${n.params.id}/pwreset`)},onReload:async function(){o.value=(await d.get(`/api/people/${n.params.id}`)).data},person:o,resetPasswordModal:s}}});const Bn={key:0,id:"person-view-spinner"},Dn={key:1,id:"person-view"},Un={id:"person-view-grid"},_n=h("div",{class:"person-view-spacer"},null,-1),Hn={id:"person-view-chpw"},In=P("Change Password"),zn=P("Reset Password");$n.render=function(e,n,o,t,s,a){const r=p("SSpinner"),l=p("PersonViewNames"),i=p("PersonViewRoles"),d=p("PersonViewContact"),u=p("PersonViewStatus"),w=p("PersonViewNotes"),g=p("PersonViewSubscriptions"),y=p("SButton"),b=p("PersonViewSection"),C=p("PersonEditPassword"),S=p("MessageBox");return e.person?(m(),c("div",Dn,[h("div",Un,[h(l,{person:e.person,onReload:e.onReload},null,8,["person","onReload"]),_n,h(i,{person:e.person,onReload:e.onReload,style:{"grid-row":"2/3"}},null,8,["person","onReload"]),h(d,{person:e.person,onReload:e.onReload},null,8,["person","onReload"]),h(u,{person:e.person,onReload:e.onReload},null,8,["person","onReload"]),h(w,{person:e.person,onReload:e.onReload},null,8,["person","onReload"]),h(g,{person:e.person,onReload:e.onReload},null,8,["person","onReload"]),e.person.canChangePassword||e.person.canResetPassword?(m(),c(b,{key:0,title:"Password",editable:!1},{default:v((()=>[h("div",Hn,[e.person.canChangePassword?(m(),c(y,{key:0,variant:"primary",small:"",onClick:e.onChangePassword},{default:v((()=>[In])),_:1},8,["onClick"])):f("",!0),e.person.canResetPassword?(m(),c(y,{key:1,variant:"primary",small:"",onClick:e.onResetPassword},{default:v((()=>[zn])),_:1},8,["onClick"])):f("",!0)])])),_:1})):f("",!0)]),e.person.canChangePassword?(m(),c(C,{key:0,ref:"changePasswordModal",pid:e.person.id},null,8,["pid"])):f("",!0),h(S,{ref:"resetPasswordModal",title:"Reset Password",variant:"warning",okLabel:"Reset Password"},{default:v((()=>[P("This will replace "+k(e.person.informalName)+"’s current password with a new, randomly generated one, and send it to them by email. You should do this only if they have explicitly asked you to. Are you sure you want to reset "+k(e.person.informalName)+"’s password?",1)])),_:1},512)])):(m(),c("div",Bn,[h(r)]))};export default $n;
