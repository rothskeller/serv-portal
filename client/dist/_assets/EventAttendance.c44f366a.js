let e=document.createElement("style");e.innerHTML=".event-attend-person{margin-right:.75rem}.event-attend-person-hours{display:inline-block;margin-right:.25rem;width:3rem;border-radius:4px;color:#fff;text-align:center;line-height:1.2}.event-attend-person-volunteer{background-color:#4363d8}.event-attend-person-student{background-color:#3cb44b}.event-attend-person-audit{background-color:#a9a9a9}.event-attend-person-absent{background-color:maroon}#event-attendance,#event-attendance-spinner{padding:1.5rem .75rem}#event-attend-settings{margin-bottom:.75rem}#event-attend-type{margin:0 1.5rem 0 .5rem}#event-attend-hours{margin-left:.5rem;max-width:5rem}@media (min-width:576px){#event-attendance{display:grid;height:100%;grid:-webkit-max-content 1fr -webkit-max-content/100%;grid:max-content 1fr max-content/100%}#event-attend-group{display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-start;overflow-x:auto;overflow-y:hidden;min-height:0}#event-attend-group .custom-checkbox{margin-right:1.5rem}}#event-attend-submit{display:flex;flex-wrap:wrap;margin:.75rem 0 0 -.5rem}#event-attend-submit .sbtn{margin-left:.5rem}@media print{#event-attend-settings,#event-attend-submit{display:none}}#event-attend-cancel{margin-right:2rem}",document.head.appendChild(e);import{d as t,m as n,c as a,a as o,t as s,o as d,S as r,P as i,Q as l,e as u,f as p,_ as m,C as c,n as v,u as g,r as f,h as y,F as h,g as b,A as S,w as k,b as w}from"./index.1eb49c0d.js";import{s as x}from"./page.af2eb29f.js";import{s as C}from"./EventAttendanceGuest.170533e9.js";var A=t({props:{person:{type:Object,required:!0}},emits:["toggle"],setup:(e,{emit:t})=>({fmtName:function(e){return e.callSign?`${e.sortName} ${e.callSign}`:e.sortName},hoursClass:n((()=>e.person.attended?`event-attend-person-${e.person.attended.type.toLowerCase()}`:null)),hoursLabel:n((()=>{if(!e.person.attended)return"";if(!e.person.attended.minutes)return e.person.attended.type.substr(0,1);let t=Math.floor(e.person.attended.minutes/60).toString();return e.person.attended.minutes%60!=0&&(t+="Â½"),t})),onClick:function(){t("toggle")}})});A.render=function(e,t,n,r,i,l){return d(),a("div",{class:"event-attend-person",onClick:t[1]||(t[1]=(...t)=>e.onClick&&e.onClick(...t))},[o("span",{class:["event-attend-person-hours",e.hoursClass],textContent:s(e.hoursLabel)},null,10,["textContent"]),o("span",{textContent:s(e.fmtName(e.person))},null,8,["textContent"])])};var E=t({components:{EventAttendanceGuest:C,EventAttendancePerson:A,SButton:r,SInput:i,SSelect:l,SSpinner:u},props:{onLoadEvent:{type:Function,required:!0}},setup(e){const t=v(),a=g();x({title:"Events"});const o=p(null),s=p(null);m.get(`/api/events/${t.params.id}?attendance=1`).then((n=>{o.value=n.data.event,s.value=n.data.people,r.value=c(o.value.end,"HH:mm").diff(c(o.value.start,"HH:mm"),"hours",!0),"NEW"===t.params.id?x({title:"New Event"}):x({title:`${o.value.date} ${o.value.name}`,browserTitle:o.value.date}),e.onLoadEvent(o.value)}));const d=p("Volunteer"),r=p(1),i=n({get:()=>r.value.toString(),set:e=>{r.value=parseFloat(e)}});const l=p(null);async function u(){const e=new FormData;s.value.forEach((t=>{t.attended&&(e.append("person",t.id.toString()),e.append("type",t.attended.type),e.append("minutes",t.attended.minutes.toString()))})),await m.post(`/api/events/${t.params.id}/attendance`,e)}return{event:o,guestDialog:l,onAddGuest:async function(){const e=await l.value.show();if(!e)return;const t=s.value.find((t=>t.id===e.id));t?t.attended={type:d.value,minutes:60*r.value}:(s.value.push({id:e.id,sortName:e.sortName,callSign:"",attended:{type:d.value,minutes:60*r.value}}),s.value.sort(((e,t)=>e.sortName<t.sortName?-1:e.sortName>t.sortName?1:0)))},onCancel:function(){a.go(-1)},onSave:async function(){await u(),a.push(`/events/${t.params.id}`)},onTimesheetView:async function(){await u(),a.replace(`/events/${t.params.id}/timesheet`)},onTogglePerson:function(e){var t;(null==(t=o.value)?void 0:t.canEditAttendance)&&(e.attended&&e.attended.type===d.value?e.attended=!1:e.attended?e.attended.type=d.value:e.attended={type:d.value,minutes:60*r.value})},people:s,setHoursS:i,setType:d,typeOptions:[{value:"Volunteer",label:"Volunteer"},{value:"Student",label:"Student"},{value:"Audit",label:"Auditor"},{value:"Absent",label:"Absentee"}]}}});const N={key:0,id:"event-attendance-spinner"},T={key:0,id:"event-attend-settings"},V=o("label",{for:"event-attend-type"},"Set attendance for:",-1),H=o("label",{for:"event-attend-hours"},"Hours:",-1),$={id:"event-attend-group"},G={key:1,id:"event-attend-submit"},L=w("Save Attendance"),P=w("Cancel"),_=w("Add Guest"),j=w("Timesheet View");E.render=function(e,t,n,s,r,i){const l=f("SSpinner"),u=f("SSelect"),p=f("SInput"),m=f("EventAttendancePerson"),c=f("SButton"),v=f("EventAttendanceGuest");return e.event?(d(),a("form",{key:1,id:"event-attendance",onSubmit:t[3]||(t[3]=S(((...t)=>e.onSave&&e.onSave(...t)),["prevent"]))},[e.event.canEditAttendance?(d(),a("div",T,[V,o(u,{id:"event-attend-type",options:e.typeOptions,modelValue:e.setType,"onUpdate:modelValue":t[1]||(t[1]=t=>e.setType=t)},null,8,["options","modelValue"]),H,o(p,{id:"event-attend-hours",modelValue:e.setHoursS,"onUpdate:modelValue":t[2]||(t[2]=t=>e.setHoursS=t),type:"number",min:"0",max:"24",step:"0.5"},null,8,["modelValue"])])):y("",!0),o("div",$,[(d(!0),a(h,null,b(e.people,(t=>(d(),a(m,{key:t.id,person:t,onToggle:n=>e.onTogglePerson(t)},null,8,["person","onToggle"])))),128))]),e.event.canEditAttendance?(d(),a("div",G,[o(c,{type:"submit",variant:"primary"},{default:k((()=>[L])),_:1}),o(c,{id:"event-attend-cancel",onClick:e.onCancel},{default:k((()=>[P])),_:1},8,["onClick"]),o(c,{onClick:e.onAddGuest},{default:k((()=>[_])),_:1},8,["onClick"]),o(c,{onClick:e.onTimesheetView},{default:k((()=>[j])),_:1},8,["onClick"])])):y("",!0),e.event.canEditAttendance?(d(),a(v,{key:2,ref:"guestDialog"},null,512)):y("",!0)],32)):(d(),a("div",N,[o(l)]))};export default E;
