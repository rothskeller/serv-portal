let e=document.createElement("style");e.innerHTML="#search{margin:1.5rem .75rem}#search-query-row{text-align:center}#search-query{display:inline;margin-right:.25rem;width:10rem;vertical-align:bottom}#search-error{margin-top:.75rem;color:red;text-align:center}#search-results{margin-top:.75rem}.search-result-type{padding-top:.75rem;text-decoration:underline}.search-result{margin-left:2rem;text-indent:-2rem;line-height:1.2}.search-result-path{padding-left:1rem;font-style:italic;font-size:.75rem}",document.head.appendChild(e);import{d as t,s,M as r,f as l,_ as a,n,u,r as o,o as i,c,a as d,w as h,A as p,t as m,h as v,F as f,g as y,b as g}from"./index.2fd13a4d.js";import{s as x}from"./page.3484299e.js";var q=t({components:{SButton:s,SInput:r},setup(){const e=n(),t=u();x({title:"Search"});const s=l("");e.query.q&&(s.value=e.query.q,v());const r=l([]),o=l([]),i=l([]),c=l([]),d=l([]),h=l([]),p=l(""),m=l(!1);async function v(){if(s.value=s.value.trim(),!s.value)return r.value=o.value=i.value=d.value=c.value=h.value=[],void(p.value="");s.value!==e.query.q&&t.replace({path:"/search",query:{q:s.value}});const l=(await a.get("/api/search",{params:{q:s.value}})).data;p.value=l.error||"",r.value=l.results.filter((e=>"document"===e.type)),o.value=l.results.filter((e=>"event"===e.type)),i.value=l.results.filter((e=>"folder"===e.type)),c.value=l.results.filter((e=>"person"===e.type)),d.value=l.results.filter((e=>"role"===e.type)),h.value=l.results.filter((e=>"textMessage"===e.type)),m.value=!0}return{documents:r,error:p,events:o,folders:i,onSubmit:v,people:c,query:s,resultPath:function(e){return e.path.length?"in "+e.path.join(" > "):""},roles:d,submitted:m,textMessages:h}}});const b={id:"search"},k={id:"search-query-row"},S=g("Search"),M={id:"search-results"},_=d("div",{class:"search-result-type"},"Roles",-1),C={class:"search-result"},w=d("div",{class:"search-result-type"},"People",-1),$={class:"search-result"},F=d("div",{class:"search-result-type"},"Events",-1),P={class:"search-result"},j=d("div",{class:"search-result-type"},"Folders",-1),V={class:"search-result"},B=d("div",{class:"search-result-type"},"Files",-1),E={class:"search-result"},I=d("div",{class:"search-result-type"},"Text Messages",-1),N={class:"search-result"},T={key:6,class:"search-result"};q.render=function(e,t,s,r,l,a){const n=o("SInput"),u=o("SButton"),x=o("router-link");return i(),c("div",b,[d("form",{id:"search-form",onSubmit:t[2]||(t[2]=p(((...t)=>e.onSubmit&&e.onSubmit(...t)),["prevent"]))},[d("div",k,[d(n,{id:"search-query",autofocus:"",modelValue:e.query,"onUpdate:modelValue":t[1]||(t[1]=t=>e.query=t)},null,8,["modelValue"]),d(u,{type:"submit",variant:"primary"},{default:h((()=>[S])),_:1})])],32),e.error?(i(),c("div",{key:0,id:"search-error",textContent:m(e.error)},null,8,["textContent"])):v("",!0),d("div",M,[e.roles.length?(i(),c(f,{key:0},[_,(i(!0),c(f,null,y(e.roles,(e=>(i(),c("div",C,[d(x,{to:`/people/list?role=${e.id}`},{default:h((()=>[g(m(e.name),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),e.people.length?(i(),c(f,{key:1},[w,(i(!0),c(f,null,y(e.people,(e=>(i(),c("div",$,[d(x,{to:`/people/${e.id}`},{default:h((()=>[g(m(e.informalName),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),e.events.length?(i(),c(f,{key:2},[F,(i(!0),c(f,null,y(e.events,(e=>(i(),c("div",P,[d(x,{to:`/events/${e.id}`},{default:h((()=>[g(m(e.date)+" "+m(e.name),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),e.folders.length?(i(),c(f,{key:3},[j,(i(!0),c(f,null,y(e.folders,(t=>(i(),c("div",V,[d(x,{to:`/files${t.url}`},{default:h((()=>[g(m(t.name),1)])),_:2},1032,["to"]),d("span",{class:"search-result-path",textContent:m(e.resultPath(t))},null,8,["textContent"])])))),256))],64)):v("",!0),e.documents.length?(i(),c(f,{key:4},[B,(i(!0),c(f,null,y(e.documents,(t=>(i(),c("div",E,[d("a",{href:t.url,target:t.newtab?"_blank":null},m(t.name),9,["href","target"]),d("span",{class:"search-result-path",textContent:m(e.resultPath(t))},null,8,["textContent"])])))),256))],64)):v("",!0),e.textMessages.length?(i(),c(f,{key:5},[I,(i(!0),c(f,null,y(e.textMessages,(e=>(i(),c("div",N,[d(x,{to:`/texts/${e.id}`},{default:h((()=>[g("From "+m(e.sender)+" on "+m(e.timestamp.substr(0,10)),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),!e.submitted||e.error||e.roles.length||e.people.length||e.events.length||e.folders.length||e.documents.length||e.textMessages.length?v("",!0):(i(),c("div",T,"No results found."))])])};export default q;
