let e=document.createElement("style");e.innerHTML="#event-attendance-guest-title{font-size:1.25rem;font-weight:500;padding:.75rem;color:#fff;background-color:#007bff}#event-attendance-guest{display:flex;flex-direction:column;align-items:stretch;padding:.75rem}#event-attendance-guest-input{margin-bottom:.25rem}#event-attendance-guest-buttons{padding-top:.75rem;border-top:1px solid rgba(0,0,0,.2);text-align:right}#event-attendance-guest-buttons .sbtn{margin-right:.5rem}.event-attend-person{margin-right:.75rem}.event-attend-person-hours{display:inline-block;margin-right:.25rem;width:3rem;border-radius:4px;color:#fff;text-align:center;line-height:1.2}.event-attend-person-volunteer{background-color:#4363d8}.event-attend-person-student{background-color:#3cb44b}.event-attend-person-audit{background-color:#a9a9a9}.event-attend-person-absent{background-color:maroon}#event-attendance,#event-attendance-spinner{padding:1.5rem .75rem}#event-attend-settings{margin-bottom:.75rem}#event-attend-type{margin:0 1.5rem 0 .5rem}#event-attend-hours{margin-left:.5rem;max-width:5rem}@media (min-width:576px){#event-attendance{display:grid;height:100%;grid:-webkit-max-content 1fr -webkit-max-content/100%;grid:max-content 1fr max-content/100%}#event-attend-group{display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-start;overflow-x:auto;overflow-y:hidden;min-height:0}#event-attend-group .custom-checkbox{margin-right:1.5rem}}#event-attend-submit{display:flex;flex-wrap:wrap;margin:.75rem 0 0 -.5rem}#event-attend-submit .sbtn{margin-left:.5rem}@media print{#event-attend-settings,#event-attend-submit{display:none}}#event-attend-cancel{margin-right:2rem}",document.head.appendChild(e);import{d as t,j as n,s as a,P as o,f as s,C as r,O as d,_ as l,r as u,c as i,o as p,w as v,a as m,K as c,L as g,F as f,g as b,t as h,D as y,b as S,u as x,Q as C,e as w,H as k,v as A,x as V}from"./index.69270c2b.js";import{s as E}from"./page.0f9cb5de.js";var N=t({components:{Modal:n,SButton:a,SInput:o},setup(e,{emit:t}){const n=s(null),a=s(null);const o=s(""),u=s(0),i=s([]);return r(o,(async()=>{if(!o.value.trim())return i.value=[],void(u.value=0);i.value=(await l.get("/api/people",{params:{search:o.value.trim()}})).data,u.value=1===i.value.length?i.value[0].id:0})),{guest:u,input:a,modal:n,onSubmit:function(){u.value&&n.value.close(i.value.find((e=>e.id===u.value)))},options:i,search:o,show:function(){return function e(){a.value?a.value.focus():d(e)}(),n.value.show()}}}});const H=m("div",{id:"event-attendance-guest-title"},"Add Guest",-1),T={id:"event-attendance-guest-buttons"},G=S("Cancel"),L=S("OK");N.render=function(e,t,n,a,o,s){const r=u("SInput"),d=u("SButton"),l=u("Modal");return p(),i(l,{ref:"modal"},{default:v((({close:n})=>[H,m("form",{id:"event-attendance-guest",onSubmit:t[3]||(t[3]=y(((...t)=>e.onSubmit(...t)),["prevent"]))},[m(r,{id:"event-attendance-guest-input",ref:"input",placeholder:"Guest Name",modelValue:e.search,"onUpdate:modelValue":t[1]||(t[1]=t=>e.search=t)},null,8,["modelValue"]),c(m("select",{size:"10","onUpdate:modelValue":t[2]||(t[2]=t=>e.guest=t)},[(p(!0),i(f,null,b(e.options,(e=>(p(),i("option",{value:e.id,textContent:h(e.sortName)},null,8,["value","textContent"])))),256))],512),[[g,e.guest]]),m("div",T,[m(d,{onClick:e=>n(null)},{default:v((()=>[G])),_:1},8,["onClick"]),m(d,{type:"submit",variant:"primary"},{default:v((()=>[L])),_:1})])],32)])),_:1},512)};var _=t({props:{person:{type:Object,required:!0}},emits:["toggle"],setup:(e,{emit:t})=>({hoursClass:x((()=>e.person.attended?"event-attend-person-"+e.person.attended.type.toLowerCase():null)),hoursLabel:x((()=>{if(!e.person.attended)return"";if(!e.person.attended.minutes)return e.person.attended.type.substr(0,1);let t=Math.floor(e.person.attended.minutes/60).toString();return e.person.attended.minutes%60!=0&&(t+="Â½"),t})),onClick:function(){t("toggle")}})});_.render=function(e,t,n,a,o,s){return p(),i("div",{class:"event-attend-person",onClick:t[1]||(t[1]=(...t)=>e.onClick(...t))},[m("span",{class:["event-attend-person-hours",e.hoursClass],textContent:h(e.hoursLabel)},null,10,["textContent"]),m("span",{textContent:h(e.person.sortName)},null,8,["textContent"])])};var O=t({components:{EventAttendanceGuest:N,EventAttendancePerson:_,SButton:a,SInput:o,SSelect:C,SSpinner:w},props:{onLoadEvent:{type:Function,required:!0}},setup(e){const t=A(),n=V();E({title:"Events"});const a=s(null),o=s(null);l.get(`/api/events/${t.params.id}?attendance=1`).then((n=>{a.value=n.data.event,o.value=n.data.people,d.value=k(a.value.end,"HH:mm").diff(k(a.value.start,"HH:mm"),"hours",!0),"NEW"===t.params.id?E({title:"New Event"}):E({title:`${a.value.date} ${a.value.name}`,browserTitle:a.value.date}),e.onLoadEvent(a.value)}));const r=s("Volunteer"),d=s(1),u=x({get:()=>d.value.toString(),set:e=>{d.value=parseFloat(e)}});const i=s(null);return{event:a,guestDialog:i,onAddGuest:async function(){const e=await i.value.show();if(!e)return;const t=o.value.find((t=>t.id===e.id));t?t.attended={type:r.value,minutes:60*d.value}:(o.value.push({id:e.id,sortName:e.sortName,attended:{type:r.value,minutes:60*d.value}}),o.value.sort(((e,t)=>e.sortName<t.sortName?-1:e.sortName>t.sortName?1:0)))},onCancel:function(){n.go(-1)},onSave:async function(){const e=new FormData;o.value.forEach((t=>{t.attended&&(e.append("person",t.id.toString()),e.append("type",t.attended.type),e.append("minutes",t.attended.minutes.toString()))})),await l.post(`/api/events/${t.params.id}/attendance`,e),n.push("/events/"+t.params.id)},onTogglePerson:function(e){e.attended&&e.attended.type===r.value?e.attended=!1:e.attended={type:r.value,minutes:60*d.value}},people:o,setHoursS:u,setType:r,typeOptions:[{value:"Volunteer",label:"Volunteer"},{value:"Student",label:"Student"},{value:"Audit",label:"Auditor"},{value:"Absent",label:"Absentee"}]}}});const P={key:0,id:"event-attendance-spinner"},j={id:"event-attend-settings"},B=m("label",{for:"event-attend-type"},"Set attendance for:",-1),D=m("label",{for:"event-attend-hours"},"Hours:",-1),F={id:"event-attend-group"},I={id:"event-attend-submit"},M=S("Save Attendance"),U=S("Cancel"),$=S("Add Guest");O.render=function(e,t,n,a,o,s){const r=u("SSpinner"),d=u("SSelect"),l=u("SInput"),c=u("EventAttendancePerson"),g=u("SButton"),h=u("EventAttendanceGuest");return e.event?(p(),i("form",{key:1,id:"event-attendance",onSubmit:t[3]||(t[3]=y(((...t)=>e.onSave(...t)),["prevent"]))},[m("div",j,[B,m(d,{id:"event-attend-type",options:e.typeOptions,modelValue:e.setType,"onUpdate:modelValue":t[1]||(t[1]=t=>e.setType=t)},null,8,["options","modelValue"]),D,m(l,{id:"event-attend-hours",modelValue:e.setHoursS,"onUpdate:modelValue":t[2]||(t[2]=t=>e.setHoursS=t),type:"number",min:"0",max:"24",step:"0.5"},null,8,["modelValue"])]),m("div",F,[(p(!0),i(f,null,b(e.people,(t=>(p(),i(c,{key:t.id,person:t,onToggle:n=>e.onTogglePerson(t)},null,8,["person","onToggle"])))),128))]),m("div",I,[m(g,{type:"submit",variant:"primary"},{default:v((()=>[M])),_:1}),m(g,{id:"event-attend-cancel",onClick:e.onCancel},{default:v((()=>[U])),_:1},8,["onClick"]),m(g,{onClick:e.onAddGuest},{default:v((()=>[$])),_:1},8,["onClick"])]),m(h,{ref:"guestDialog"},null,512)],32)):(p(),i("div",P,[m(r)]))};export default O;
