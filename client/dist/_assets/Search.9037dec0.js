let e=document.createElement("style");e.innerHTML="#search{margin:1.5rem .75rem}#search-query-row{text-align:center}#search-query{display:inline;margin-right:.25rem;width:10rem;vertical-align:bottom}#search-error{margin-top:.75rem;color:red;text-align:center}#search-results{margin-top:.75rem}.search-result-type{padding-top:.75rem;text-decoration:underline}.search-result{margin-left:2rem;text-indent:-2rem;line-height:1.2}.search-result-path{padding-left:1rem;font-style:italic;font-size:.75rem}",document.head.appendChild(e);import{d as t,s,P as r,f as l,I as a,_ as n,v as u,x as o,r as i,c,a as d,w as h,D as p,t as m,z as v,F as f,g as y,o as g,b as x}from"./index.0c6bec11.js";import{s as q}from"./page.a9595226.js";var b=t({components:{SButton:s,SInput:r},setup(){const e=u(),t=o();q({title:"Search"});const s=l("");e.query.q&&(s.value=e.query.q,y());const r=l(null);a((()=>{r.value.focus()}));const i=l([]),c=l([]),d=l([]),h=l([]),p=l([]),m=l([]),v=l(""),f=l(!1);async function y(){if(s.value=s.value.trim(),!s.value)return i.value=c.value=d.value=p.value=h.value=m.value=[],void(v.value="");s.value!==e.query.q&&t.replace({path:"/search",query:{q:s.value}});const r=(await n.get("/api/search",{params:{q:s.value}})).data;v.value=r.error||"",i.value=r.results.filter((e=>"document"===e.type)),c.value=r.results.filter((e=>"event"===e.type)),d.value=r.results.filter((e=>"folder"===e.type)),h.value=r.results.filter((e=>"person"===e.type)),p.value=r.results.filter((e=>"role"===e.type)),m.value=r.results.filter((e=>"textMessage"===e.type)),f.value=!0}return{documents:i,error:v,events:c,folders:d,onSubmit:y,people:h,query:s,queryRef:r,resultPath:function(e){return"in "+e.path.join(" > ")},roles:p,submitted:f,textMessages:m}}});const k={id:"search"},S={id:"search-query-row"},C=x("Search"),M={id:"search-results"},_=d("div",{class:"search-result-type"},"Roles",-1),w={class:"search-result"},I=d("div",{class:"search-result-type"},"People",-1),P={class:"search-result"},F=d("div",{class:"search-result-type"},"Events",-1),j={class:"search-result"},D=d("div",{class:"search-result-type"},"Folders",-1),R={class:"search-result"},V=d("div",{class:"search-result-type"},"Files",-1),z={class:"search-result"},B=d("div",{class:"search-result-type"},"Text Messages",-1),E={class:"search-result"},N={key:6,class:"search-result"};b.render=function(e,t,s,r,l,a){const n=i("SInput"),u=i("SButton"),o=i("router-link");return g(),c("div",k,[d("form",{id:"search-form",onSubmit:t[2]||(t[2]=p(((...t)=>e.onSubmit(...t)),["prevent"]))},[d("div",S,[d(n,{id:"search-query",ref:"queryRef",modelValue:e.query,"onUpdate:modelValue":t[1]||(t[1]=t=>e.query=t)},null,8,["modelValue"]),d(u,{type:"submit",variant:"primary"},{default:h((()=>[C])),_:1})])],32),e.error?(g(),c("div",{key:0,id:"search-error",textContent:m(e.error)},null,8,["textContent"])):v("",!0),d("div",M,[e.roles.length?(g(),c(f,{key:0},[_,(g(!0),c(f,null,y(e.roles,(e=>(g(),c("div",w,[d(o,{to:"/people/list?role="+e.id},{default:h((()=>[x(m(e.name),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),e.people.length?(g(),c(f,{key:1},[I,(g(!0),c(f,null,y(e.people,(e=>(g(),c("div",P,[d(o,{to:"/people/"+e.id},{default:h((()=>[x(m(e.informalName),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),e.events.length?(g(),c(f,{key:2},[F,(g(!0),c(f,null,y(e.events,(e=>(g(),c("div",j,[d(o,{to:"/events/"+e.id},{default:h((()=>[x(m(e.date)+" "+m(e.name),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),e.folders.length?(g(),c(f,{key:3},[D,(g(!0),c(f,null,y(e.folders,(t=>(g(),c("div",R,[d(o,{to:"/files/"+t.id},{default:h((()=>[x(m(t.name),1)])),_:2},1032,["to"]),t.path.length?(g(),c("span",{key:0,class:"search-result-path",textContent:m(e.resultPath(t))},null,8,["textContent"])):v("",!0)])))),256))],64)):v("",!0),e.documents.length?(g(),c(f,{key:4},[V,(g(!0),c(f,null,y(e.documents,(t=>(g(),c("div",z,[d("a",{href:`/api/folders/${t.folderID}/${t.documentID}`,download:""},m(t.name),9,["href"]),d("span",{class:"search-result-path",textContent:m(e.resultPath(t))},null,8,["textContent"])])))),256))],64)):v("",!0),e.textMessages.length?(g(),c(f,{key:5},[B,(g(!0),c(f,null,y(e.textMessages,(e=>(g(),c("div",E,[d(o,{to:"/texts/"+e.id},{default:h((()=>[x("From "+m(e.sender)+" on "+m(e.timestamp.substr(0,10)),1)])),_:2},1032,["to"])])))),256))],64)):v("",!0),!e.submitted||e.error||e.roles.length||e.people.length||e.events.length||e.folders.length||e.documents.length||e.textMessages.length?v("",!0):(g(),c("div",N,"No results found."))])])};export default b;
