let e=document.createElement("style");e.innerHTML="#person-view{margin:1.5rem .75rem}#person-view-name{display:flex;flex-direction:column}#person-view-informalName{font-weight:700;font-size:1.25rem;line-height:1.2}#person-view-callSign{margin-left:.5rem;font-weight:400}#person-view-formalName,.person-view-email-label{color:#888}@media (min-width:576px){#person-view-name{flex-direction:row}#person-view-formalName{margin-left:1rem}}#person-view-cbadge{margin-left:.5rem}#person-view-roles{line-height:1.2}#person-view-emails{margin-top:.75rem}.person-view-phone{font-variant:tabular-nums}.person-view-phone-label{margin-left:.25rem;color:#888}.person-view-address,.person-view-clearances{margin-top:.75rem;line-height:1.2}.person-view-map{margin-left:1rem}.person-view-map::before{content:'['}.person-view-map::after{content:']'}.person-view-address-flag{color:#888;font-size:.875rem}#person-view-attended{margin-top:.75rem;line-height:1.2}.person-view-attended{margin-left:2rem;text-indent:-2rem}.person-view-attended-date{margin-right:.75rem;color:#888;font-variant:tabular-nums}#person-view-notes,#person-view-unsub{margin-top:.75rem;line-height:1.2}.person-view-note{margin-left:2rem;text-indent:-2rem}.person-view-note-date{margin-right:.75rem;color:#888;font-variant:tabular-nums}",document.head.appendChild(e);import{d as n,j as o,f as s,r as t,c as r,o as l,w as i,a,m as d,l as p,p as m,e as u,C as c,_ as v,F as h,z as w,s as f,i as g,v as k,t as y,g as C,b as x}from"./index.0c6bec11.js";import{s as b}from"./SubscriptionsForm.d04b1633.js";var S=n({components:{Modal:o,SubscriptionsForm:b},props:{pid:{type:Number,required:!0}},setup(e){const n=s(null);return{modal:n,onDone:function(e){n.value.close(e)},show:function(){return n.value.show()}}}});S.render=function(e,n,o,s,d,p){const m=t("SubscriptionsForm"),u=t("Modal");return l(),r(u,{ref:"modal"},{default:i((()=>[a(m,{inModal:"",pid:e.pid,onDone:e.onDone},null,8,["pid","onDone"])])),_:1},512)};const E={admin:"Admin","cert-d":"CERT Deployment","cert-t":"CERT Training",listos:"Listos",sares:"SARES",snap:"SNAP"};var A=n({components:{Modal:o,SFCheckGroup:d,SForm:p,SFSelect:m,SSpinner:u},props:{pid:{type:Number,required:!0}},setup(e){const n=s(null);const o=s([]),t=s("");const r=s([]),l=s(new Set);c(t,(()=>{const e=o.value.find((e=>e.org===t.value)).roles;l.value=new Set(e.filter((e=>e.held)).map((e=>e.id)))})),c([l,t],((e,n)=>{let s=e[1]!=n[1];if(e[0].forEach((e=>{n[0].has(e)||(s=!0)})),n[0].forEach((n=>{e[0].has(n)||(s=!0)})),!s)return;const i=new Set,a=new Set;o.value.forEach((e=>{e.org===t.value?e.roles.filter((e=>(!e.held||e.direct)&&l.value.has(e.id))).forEach((e=>{i.add(e.id),e.implies.forEach((e=>a.add(e)))})):e.roles.filter((e=>e.held&&e.direct)).forEach((e=>{i.add(e.id),e.implies.forEach((e=>a.add(e)))}))})),o.value.forEach((e=>{e.roles.forEach((e=>{i.has(e.id)?e.held=e.direct=!0:a.has(e.id)?(e.held=!0,e.direct=!1):e.held=e.direct=!1}))}));const d=o.value.find((e=>e.org===t.value)).roles;l.value=new Set(d.filter((e=>e.held)).map((e=>e.id))),r.value=d.map((e=>({value:e.id,label:e.name,disabled:e.implicitOnly||e.held&&!e.direct})))}));const i=s(!1);return{modal:n,onCancel:function(){n.value.close(!1)},onSubmit:async function(){var s=new FormData;o.value.forEach((e=>{e.roles.filter((e=>e.held&&e.direct)).forEach((e=>{s.append("role",e.id.toString())}))})),i.value=!0,await v.post(`/api/people/${e.pid}/roles`,s),i.value=!1,n.value.close(!0)},org:t,orgRoleOptions:r,orgRoles:l,orgs:o,show:function(){return async function(){o.value=[],t.value="",o.value=(await v.get(`/api/people/${e.pid}/roles`)).data,o.value.forEach((e=>{e.fmtOrg=E[e.org]})),t.value=o.value[0].org}(),n.value.show()},submitting:i}}});A.render=function(e,n,o,s,d,p){const m=t("SSpinner"),u=t("SFSelect"),c=t("SFCheckGroup"),v=t("SForm"),f=t("Modal");return l(),r(f,{ref:"modal"},{default:i((()=>[a(v,{dialog:"",variant:"primary",title:"Edit Roles",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:i((()=>[e.orgs.length?(l(),r(h,{key:1},[e.orgs.length>1?(l(),r(u,{key:0,id:"person-roles-org",label:"Org",options:e.orgs,valueKey:"org",labelKey:"fmtOrg",modelValue:e.org,"onUpdate:modelValue":n[1]||(n[1]=n=>e.org=n)},null,8,["options","modelValue"])):w("",!0),a(c,{id:"person-roles-roles",label:e.orgs.length>1?"Roles":"",options:e.orgRoleOptions,disabledKey:"disabled",modelValue:e.orgRoles,"onUpdate:modelValue":n[2]||(n[2]=n=>e.orgRoles=n)},null,8,["label","options","modelValue"])],64)):(l(),r(m,{key:0}))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var R=n({components:{PersonEditLists:S,PersonEditRoles:A,SButton:f,SSpinner:u},props:{onLoadPerson:{type:Function,required:!0}},setup(e){const n=g("me"),o=k(),t=s(null);v.get("/api/people/"+o.params.id).then((n=>{t.value=n.data.person,e.onLoadPerson(t.value)}));const r=s(null);const l=s(null);return{editListsModal:l,editRolesModal:r,me:n,onEditLists:async function(){await l.value.show()&&(t.value=(await v.get("/api/people/"+o.params.id)).data.person)},onEditRoles:async function(){await r.value.show()&&(t.value=(await v.get("/api/people/"+o.params.id)).data.person)},person:t}}});const P={key:0,id:"person-view-spinner"},N={key:1,id:"person-view"},D={id:"person-view-name"},F={id:"person-view-informalName"},M={id:"person-view-roles"},L={key:0,id:"person-view-emails"},_={key:0},V={key:1,class:"person-view-phone"},O=a("span",{class:"person-view-phone-label"},"(Cell)",-1),T={key:2,class:"person-view-phone"},q=a("span",{class:"person-view-phone-label"},"(Home)",-1),B={key:3,class:"person-view-phone"},H=a("span",{class:"person-view-phone-label"},"(Work)",-1),U={key:4,class:"person-view-address"},j={key:0},z={key:1},I={key:5,class:"person-view-address"},K=a("span",null,"Work Address:",-1),W={key:6,class:"person-view-address"},$=a("div",null,"Mailing Address:",-1),G={key:7,class:"person-view-clearances"},J=a("div",null,"Volunteer status:",-1),Q={key:0},X=x("Sunnyvale volunteer: "),Y=a("span",{style:{color:"red"}},"not registered.",-1),Z={key:0,style:{color:"red"}},ee={key:0,style:{color:"red"}},ne={key:1},oe={key:3},se={key:4},te=x("Background check: "),re=a("span",{style:{color:"red"}},"not completed.",-1),le={key:5},ie={key:6},ae={key:8,id:"person-view-attended"},de=a("div",null,"Events attended:",-1),pe={class:"person-view-attended"},me={key:9,id:"person-view-notes"},ue=a("div",null,"Notes:",-1),ce={class:"person-view-note"},ve={key:10,id:"person-view-unsub"},he=a("div",null,"Unsubscribe:",-1),we={key:0},fe={key:1},ge={key:2},ke={key:11,id:"person-view-roles2"},ye=a("div",null,"Roles:",-1),Ce={key:0},xe={key:1},be=x("Edit"),Se={key:12,id:"person-view-lists"},Ee=a("div",null,"Lists:",-1),Ae={key:0},Re=x("Edit");R.render=function(e,n,o,s,d,p){const m=t("SSpinner"),u=t("SButton"),c=t("PersonEditRoles"),v=t("PersonEditLists");return e.person?(l(),r("div",N,[a("div",D,[a("div",F,[a("span",{textContent:y(e.person.informalName)},null,8,["textContent"]),e.person.callSign?(l(),r("span",{key:0,id:"person-view-callSign",textContent:y(e.person.callSign)},null,8,["textContent"])):w("",!0)]),e.person.formalName!==e.person.informalName?(l(),r("div",{key:0,id:"person-view-formalName",textContent:y(`(formally ${e.person.formalName})`)},null,8,["textContent"])):w("",!0)]),a("div",M,[(l(!0),r(h,null,C(e.person.roles,(e=>(l(),r("div",{textContent:y(e.name)},null,8,["textContent"])))),256))]),e.person.email?(l(),r("div",L,[a("div",null,[a("a",{href:"mailto:"+e.person.email,textContent:y(e.person.email)},null,8,["href","textContent"])]),e.person.email2?(l(),r("div",_,[a("a",{href:"mailto:"+e.person.email2,textContent:y(e.person.email2)},null,8,["href","textContent"])])):w("",!0)])):w("",!0),e.person.cellPhone?(l(),r("div",V,[a("a",{href:"tel:"+e.person.cellPhone,textContent:y(e.person.cellPhone)},null,8,["href","textContent"]),O])):w("",!0),e.person.homePhone?(l(),r("div",T,[a("a",{href:"tel:"+e.person.homePhone,textContent:y(e.person.homePhone)},null,8,["href","textContent"]),q])):w("",!0),e.person.workPhone?(l(),r("div",B,[a("a",{href:"tel:"+e.person.workPhone,textContent:y(e.person.workPhone)},null,8,["href","textContent"]),H])):w("",!0),e.person.homeAddress&&e.person.homeAddress.address?(l(),r("div",U,[a("div",null,[e.person.workAddress&&e.person.workAddress.sameAsHome?(l(),r("span",j,"Home Address (all day):")):(l(),r("span",z,"Home Address:")),a("a",{class:"person-view-map",target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(e.person.homeAddress.address)},"Map",8,["href"])]),a("div",{textContent:y(e.person.homeAddress.address.split(",")[0])},null,8,["textContent"]),a("div",{textContent:y(e.person.homeAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"]),e.person.homeAddress.fireDistrict?(l(),r("div",{key:0,textContent:y("Sunnyvale Fire District "+e.person.homeAddress.fireDistrict)},null,8,["textContent"])):w("",!0)])):w("",!0),e.person.workAddress&&e.person.workAddress.address?(l(),r("div",I,[a("div",null,[K,a("a",{class:"person-view-map",target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(e.person.workAddress.address)},"Map",8,["href"])]),a("div",{textContent:y(e.person.workAddress.address.split(",")[0])},null,8,["textContent"]),a("div",{textContent:y(e.person.workAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"]),e.person.workAddress.fireDistrict?(l(),r("div",{key:0,textContent:y("Sunnyvale Fire District "+e.person.workAddress.fireDistrict)},null,8,["textContent"])):w("",!0)])):w("",!0),e.person.mailAddress&&e.person.mailAddress.address?(l(),r("div",W,[$,a("div",{textContent:y(e.person.mailAddress.address.split(",")[0])},null,8,["textContent"]),a("div",{textContent:y(e.person.mailAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"])])):w("",!0),e.person.dsw||void 0!==e.person.volgistics||void 0!==e.person.backgroundCheck?(l(),r("div",G,[J,!1===e.person.volgistics?(l(),r("div",Q,[X,Y])):e.person.volgistics&&!0!==e.person.volgistics?(l(),r("div",{key:1,textContent:y("Sunnyvale volunteer #"+e.person.volgistics)},null,8,["textContent"])):w("",!0),e.person.dsw?(l(!0),r(h,{key:2},C(e.person.dsw,((e,n)=>(l(),r("div",null,[x("DSW for "+y(n)+": ",1),e.needed&&!e.registered?(l(),r("span",Z,"not registered.")):(l(),r(h,{key:1},[x("registered "+y(e.registered)+", ",1),e.expired?(l(),r("span",ee,"expired")):(l(),r("span",ne,"expires")),x(" "+y(e.expires)+".",1)],64))])))),256)):w("",!0),!0===e.person.backgroundCheck?(l(),r("div",oe,"Background check cleared.")):!1===e.person.backgroundCheck?(l(),r("div",se,[te,re])):e.person.backgroundCheck?(l(),r("div",le,"Background check cleared on "+y(e.person.backgroundCheck)+".",1)):w("",!0),e.person.identification.length?(l(),r("div",ie,"IDs issued: "+y(e.person.identification.join(", ")),1)):w("",!0)])):w("",!0),e.person.attended?(l(),r("div",ae,[de,(l(!0),r(h,null,C(e.person.attended,(e=>(l(),r("div",pe,[a("span",{class:"person-view-attended-date",textContent:y(e.date)},null,8,["textContent"]),a("span",{textContent:y(e.name)},null,8,["textContent"])])))),256))])):w("",!0),e.person.notes&&e.person.notes.length?(l(),r("div",me,[ue,(l(!0),r(h,null,C(e.person.notes,(e=>(l(),r("div",ce,[a("span",{class:"person-view-note-date",textContent:y(e.date)},null,8,["textContent"]),a("span",{textContent:y(e.note)},null,8,["textContent"])])))),256))])):w("",!0),e.person.noEmail||e.person.noText?(l(),r("div",ve,[he,e.person.noEmail&&e.person.noText?(l(),r("div",we,"from all emails and text messages")):e.person.noEmail?(l(),r("div",fe,"from all emails")):(l(),r("div",ge,"from all text messages"))])):w("",!0),e.me.webmaster?(l(),r("div",ke,[ye,(l(!0),r(h,null,C(e.person.roles2,(e=>(l(),r("div",{textContent:y(e)},null,8,["textContent"])))),256)),e.person.roles2.length?w("",!0):(l(),r("div",Ce,"None")),e.person.canEditRoles2?(l(),r("div",xe,[a(u,{variant:"secondary",small:"",onClick:e.onEditRoles},{default:i((()=>[be])),_:1},8,["onClick"])])):w("",!0),a(c,{ref:"editRolesModal",pid:e.person.id},null,8,["pid"])])):w("",!0),e.me.webmaster&&e.person.lists?(l(),r("div",Se,[Ee,(l(!0),r(h,null,C(e.person.lists,(e=>(l(),r("div",{textContent:y(e)},null,8,["textContent"])))),256)),e.person.lists.length?w("",!0):(l(),r("div",Ae,"None")),a("div",null,[a(u,{variant:"secondary",small:"",onClick:e.onEditLists},{default:i((()=>[Re])),_:1},8,["onClick"])]),a(v,{ref:"editListsModal",pid:e.person.id},null,8,["pid"])])):w("",!0)])):(l(),r("div",P,[a(m)]))};export default R;
