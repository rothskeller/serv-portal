let e=document.createElement("style");e.innerHTML="#event-attendance-guest-title{font-size:1.25rem;font-weight:500;padding:.75rem;color:#fff;background-color:#007bff}#event-attendance-guest{display:flex;flex-direction:column;align-items:stretch;padding:.75rem}#event-attendance-guest-input{margin-bottom:.25rem}#event-attendance-guest-buttons{padding-top:.75rem;border-top:1px solid rgba(0,0,0,.2);text-align:right}#event-attendance-guest-buttons .sbtn{margin-right:.5rem}.event-attend-person{margin-right:.75rem}.event-attend-person-hours{display:inline-block;margin-right:.25rem;width:3rem;border-radius:4px;color:#fff;text-align:center;line-height:1.2}.event-attend-person-volunteer{background-color:#4363d8}.event-attend-person-student{background-color:#3cb44b}.event-attend-person-audit{background-color:#a9a9a9}.event-attend-person-absent{background-color:maroon}#event-attendance,#event-attendance-spinner{padding:1.5rem .75rem}#event-attend-settings{margin-bottom:.75rem}#event-attend-type{margin:0 1.5rem 0 .5rem}#event-attend-hours{margin-left:.5rem;max-width:5rem}@media (min-width:576px){#event-attendance{display:grid;height:100%;grid:-webkit-max-content 1fr -webkit-max-content/100%;grid:max-content 1fr max-content/100%}#event-attend-group{display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-start;overflow-x:auto;overflow-y:hidden;min-height:0}#event-attend-group .custom-checkbox{margin-right:1.5rem}}#event-attend-submit{display:flex;flex-wrap:wrap;margin:.75rem 0 0 -.5rem}#event-attend-submit .sbtn{margin-left:.5rem}@media print{#event-attend-settings,#event-attend-submit{display:none}}#event-attend-cancel{margin-right:2rem}",document.head.appendChild(e);import{d as t,q as n,s as a,M as o,f as d,z as s,_ as r,r as l,o as u,c as i,w as p,a as m,H as v,I as c,F as g,g as f,t as b,A as h,b as y,m as S,N as x,e as C,D as w,n as k,u as A}from"./index.2fd13a4d.js";import{s as V}from"./page.3484299e.js";var N=t({components:{Modal:n,SButton:a,SInput:o},setup(e,{emit:t}){const n=d(null);const a=d(""),o=d(0),l=d([]);return s(a,(async()=>{if(!a.value.trim())return l.value=[],void(o.value=0);l.value=(await r.get("/api/people",{params:{search:a.value.trim()}})).data,o.value=1===l.value.length?l.value[0].id:0})),{guest:o,modal:n,onSubmit:function(){o.value&&n.value.close(l.value.find((e=>e.id===o.value)))},options:l,search:a,show:function(){return n.value.show()}}}});const E=m("div",{id:"event-attendance-guest-title"},"Add Guest",-1),H={id:"event-attendance-guest-buttons"},T=y("Cancel"),G=y("OK");N.render=function(e,t,n,a,o,d){const s=l("SInput"),r=l("SButton"),y=l("Modal");return u(),i(y,{ref:"modal"},{default:p((({close:n})=>[E,m("form",{id:"event-attendance-guest",onSubmit:t[3]||(t[3]=h(((...t)=>e.onSubmit&&e.onSubmit(...t)),["prevent"]))},[m(s,{id:"event-attendance-guest-input",placeholder:"Guest Name",autofocus:"",modelValue:e.search,"onUpdate:modelValue":t[1]||(t[1]=t=>e.search=t)},null,8,["modelValue"]),v(m("select",{size:"10","onUpdate:modelValue":t[2]||(t[2]=t=>e.guest=t)},[(u(!0),i(g,null,f(e.options,(e=>(u(),i("option",{value:e.id,textContent:b(e.sortName)},null,8,["value","textContent"])))),256))],512),[[c,e.guest]]),m("div",H,[m(r,{onClick:e=>n(null)},{default:p((()=>[T])),_:2},1032,["onClick"]),m(r,{type:"submit",variant:"primary"},{default:p((()=>[G])),_:1})])],32)])),_:1},512)};var _=t({props:{person:{type:Object,required:!0}},emits:["toggle"],setup:(e,{emit:t})=>({hoursClass:S((()=>e.person.attended?`event-attend-person-${e.person.attended.type.toLowerCase()}`:null)),hoursLabel:S((()=>{if(!e.person.attended)return"";if(!e.person.attended.minutes)return e.person.attended.type.substr(0,1);let t=Math.floor(e.person.attended.minutes/60).toString();return e.person.attended.minutes%60!=0&&(t+="Â½"),t})),onClick:function(){t("toggle")}})});_.render=function(e,t,n,a,o,d){return u(),i("div",{class:"event-attend-person",onClick:t[1]||(t[1]=(...t)=>e.onClick&&e.onClick(...t))},[m("span",{class:["event-attend-person-hours",e.hoursClass],textContent:b(e.hoursLabel)},null,10,["textContent"]),m("span",{textContent:b(e.person.sortName)},null,8,["textContent"])])};var L=t({components:{EventAttendanceGuest:N,EventAttendancePerson:_,SButton:a,SInput:o,SSelect:x,SSpinner:C},props:{onLoadEvent:{type:Function,required:!0}},setup(e){const t=k(),n=A();V({title:"Events"});const a=d(null),o=d(null);r.get(`/api/events/${t.params.id}?attendance=1`).then((n=>{a.value=n.data.event,o.value=n.data.people,l.value=w(a.value.end,"HH:mm").diff(w(a.value.start,"HH:mm"),"hours",!0),"NEW"===t.params.id?V({title:"New Event"}):V({title:`${a.value.date} ${a.value.name}`,browserTitle:a.value.date}),e.onLoadEvent(a.value)}));const s=d("Volunteer"),l=d(1),u=S({get:()=>l.value.toString(),set:e=>{l.value=parseFloat(e)}});const i=d(null);return{event:a,guestDialog:i,onAddGuest:async function(){const e=await i.value.show();if(!e)return;const t=o.value.find((t=>t.id===e.id));t?t.attended={type:s.value,minutes:60*l.value}:(o.value.push({id:e.id,sortName:e.sortName,attended:{type:s.value,minutes:60*l.value}}),o.value.sort(((e,t)=>e.sortName<t.sortName?-1:e.sortName>t.sortName?1:0)))},onCancel:function(){n.go(-1)},onSave:async function(){const e=new FormData;o.value.forEach((t=>{t.attended&&(e.append("person",t.id.toString()),e.append("type",t.attended.type),e.append("minutes",t.attended.minutes.toString()))})),await r.post(`/api/events/${t.params.id}/attendance`,e),n.push(`/events/${t.params.id}`)},onTogglePerson:function(e){e.attended&&e.attended.type===s.value?e.attended=!1:e.attended?e.attended.type=s.value:e.attended={type:s.value,minutes:60*l.value}},people:o,setHoursS:u,setType:s,typeOptions:[{value:"Volunteer",label:"Volunteer"},{value:"Student",label:"Student"},{value:"Audit",label:"Auditor"},{value:"Absent",label:"Absentee"}]}}});const $={key:0,id:"event-attendance-spinner"},I={id:"event-attend-settings"},M=m("label",{for:"event-attend-type"},"Set attendance for:",-1),B=m("label",{for:"event-attend-hours"},"Hours:",-1),D={id:"event-attend-group"},F={id:"event-attend-submit"},O=y("Save Attendance"),P=y("Cancel"),U=y("Add Guest");L.render=function(e,t,n,a,o,d){const s=l("SSpinner"),r=l("SSelect"),v=l("SInput"),c=l("EventAttendancePerson"),b=l("SButton"),y=l("EventAttendanceGuest");return e.event?(u(),i("form",{key:1,id:"event-attendance",onSubmit:t[3]||(t[3]=h(((...t)=>e.onSave&&e.onSave(...t)),["prevent"]))},[m("div",I,[M,m(r,{id:"event-attend-type",options:e.typeOptions,modelValue:e.setType,"onUpdate:modelValue":t[1]||(t[1]=t=>e.setType=t)},null,8,["options","modelValue"]),B,m(v,{id:"event-attend-hours",modelValue:e.setHoursS,"onUpdate:modelValue":t[2]||(t[2]=t=>e.setHoursS=t),type:"number",min:"0",max:"24",step:"0.5"},null,8,["modelValue"])]),m("div",D,[(u(!0),i(g,null,f(e.people,(t=>(u(),i(c,{key:t.id,person:t,onToggle:n=>e.onTogglePerson(t)},null,8,["person","onToggle"])))),128))]),m("div",F,[m(b,{type:"submit",variant:"primary"},{default:p((()=>[O])),_:1}),m(b,{id:"event-attend-cancel",onClick:e.onCancel},{default:p((()=>[P])),_:1},8,["onClick"]),m(b,{onClick:e.onAddGuest},{default:p((()=>[U])),_:1},8,["onClick"])]),m(y,{ref:"guestDialog"},null,512)],32)):(u(),i("div",$,[m(s)]))};export default L;
