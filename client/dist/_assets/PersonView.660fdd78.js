let e=document.createElement("style");e.innerHTML=".person-lists-warning{margin:0 .75rem;color:red;line-height:1.2;white-space:pre-wrap}#person-view{margin:1.5rem .75rem}#person-view-name{display:flex;flex-direction:column}#person-view-informalName{font-weight:700;font-size:1.25rem;line-height:1.2}#person-view-callSign{margin-left:.5rem;font-weight:400}#person-view-formalName,.person-view-email-label{color:#888}@media (min-width:576px){#person-view-name{flex-direction:row}#person-view-formalName{margin-left:1rem}}#person-view-cbadge{margin-left:.5rem}#person-view-roles{line-height:1.2}#person-view-emails{margin-top:.75rem}.person-view-phone{font-variant:tabular-nums}.person-view-phone-label{margin-left:.25rem;color:#888}.person-view-address,.person-view-clearances{margin-top:.75rem;line-height:1.2}.person-view-map{margin-left:1rem}.person-view-map::before{content:'['}.person-view-map::after{content:']'}.person-view-address-flag{color:#888;font-size:.875rem}#person-view-attended{margin-top:.75rem;line-height:1.2}.person-view-attended{margin-left:2rem;text-indent:-2rem}.person-view-attended-date{margin-right:.75rem;color:#888;font-variant:tabular-nums}#person-view-notes,#person-view-unsub{margin-top:.75rem;line-height:1.2}.person-view-note{margin-left:2rem;text-indent:-2rem}.person-view-note-date{margin-right:.75rem;color:#888;font-variant:tabular-nums}",document.head.appendChild(e);import{d as n,j as s,m as o,l as t,e as r,f as l,u as a,_ as i,r as d,c as p,o as u,w as c,a as m,F as v,t as h,z as g,p as f,C as w,s as b,i as k,v as y,g as C,b as x}from"./index.3ad8832d.js";var S=n({components:{Modal:s,SFCheckGroup:o,SForm:t,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const s=l([]),o=l(new Set);const t=a((()=>s.value.filter((e=>!o.value.has(e.id)&&e.subWarn.length)).map((e=>{switch(e.subWarn.length){case 1:return`Messages sent to ${e.name} are considered required for the ${e.subWarn[0]} role.  Unsubscribing from it may cause you to lose that role.`;case 2:return`Messages sent to ${e.name} are considered required for the ${e.subWarn[0]} and ${e.subWarn[1]} roles.  Unsubscribing from it may cause you to lose those roles.`;default:return`Messages sent to ${e.name} are considered required for the ${e.subWarn.slice(0,-1).join(", ")}, and ${e.subWarn[e.subWarn.length-1]} roles.  Unsubscribing from it may cause you to lose those roles.`}})).join("\n\n"))),r=l(!1);return{lists:s,modal:n,onCancel:function(){n.value.close(!1)},onSubmit:async function(){var s=new FormData;o.value.forEach((e=>{s.append("list",e.toString())})),r.value=!0,await i.post(`/api/people/${e.pid}/lists`,s),r.value=!1,n.value.close(!0)},show:function(){return async function(){s.value=[],o.value.clear(),s.value=(await i.get(`/api/people/${e.pid}/lists`)).data,o.value.clear(),s.value.filter((e=>e.subscribed)).forEach((e=>{o.value.add(e.id)}))}(),n.value.show()},submitting:r,subscribed:o,unsubscribeWarnings:t}}});S.render=function(e,n,s,o,t,r){const l=d("SSpinner"),a=d("SFCheckGroup"),i=d("SForm"),f=d("Modal");return u(),p(f,{ref:"modal"},{default:c((()=>[m(i,{dialog:"",variant:"primary",title:"Edit List Subscriptions",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:c((()=>[e.lists.length?(u(),p(v,{key:1},[m(a,{id:"person-lists",label:"Subscriptions",options:e.lists,valueKey:"id",labelKey:"name",modelValue:e.subscribed,"onUpdate:modelValue":n[1]||(n[1]=n=>e.subscribed=n)},null,8,["options","modelValue"]),e.unsubscribeWarnings?(u(),p("div",{key:0,class:"form-item person-lists-warning",textContent:h(e.unsubscribeWarnings)},null,8,["textContent"])):g("",!0)],64)):(u(),p(l,{key:0}))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};const E={admin:"Admin","cert-d":"CERT Deployment","cert-t":"CERT Training",listos:"Listos",sares:"SARES",snap:"SNAP"};var A=n({components:{Modal:s,SFCheckGroup:o,SForm:t,SFSelect:f,SSpinner:r},props:{pid:{type:Number,required:!0}},setup(e){const n=l(null);const s=l([]),o=l("");const t=l([]),r=l(new Set);w(o,(()=>{const e=s.value.find((e=>e.org===o.value)).roles;r.value=new Set(e.filter((e=>e.held)).map((e=>e.id)))})),w([r,o],((e,n)=>{let l=e[1]!=n[1];if(e[0].forEach((e=>{n[0].has(e)||(l=!0)})),n[0].forEach((n=>{e[0].has(n)||(l=!0)})),!l)return;const a=new Set,i=new Set;s.value.forEach((e=>{e.org===o.value?e.roles.filter((e=>(!e.held||e.direct)&&r.value.has(e.id))).forEach((e=>{a.add(e.id),e.implies.forEach((e=>i.add(e)))})):e.roles.filter((e=>e.held&&e.direct)).forEach((e=>{a.add(e.id),e.implies.forEach((e=>i.add(e)))}))})),s.value.forEach((e=>{e.roles.forEach((e=>{a.has(e.id)?e.held=e.direct=!0:i.has(e.id)?(e.held=!0,e.direct=!1):e.held=e.direct=!1}))}));const d=s.value.find((e=>e.org===o.value)).roles;r.value=new Set(d.filter((e=>e.held)).map((e=>e.id))),t.value=d.map((e=>({value:e.id,label:e.name,disabled:e.implicitOnly||e.held&&!e.direct})))}));const a=l(!1);return{modal:n,onCancel:function(){n.value.close(!1)},onSubmit:async function(){var o=new FormData;s.value.forEach((e=>{e.roles.filter((e=>e.held&&e.direct)).forEach((e=>{o.append("role",e.id.toString())}))})),a.value=!0,await i.post(`/api/people/${e.pid}/roles`,o),a.value=!1,n.value.close(!0)},org:o,orgRoleOptions:t,orgRoles:r,orgs:s,show:function(){return async function(){s.value=[],o.value="",s.value=(await i.get(`/api/people/${e.pid}/roles`)).data,s.value.forEach((e=>{e.fmtOrg=E[e.org]})),o.value=s.value[0].org}(),n.value.show()},submitting:a}}});A.render=function(e,n,s,o,t,r){const l=d("SSpinner"),a=d("SFSelect"),i=d("SFCheckGroup"),h=d("SForm"),f=d("Modal");return u(),p(f,{ref:"modal"},{default:c((()=>[m(h,{dialog:"",variant:"primary",title:"Edit Roles",submitLabel:"Save",disabled:e.submitting,onSubmit:e.onSubmit,onCancel:e.onCancel},{default:c((()=>[e.orgs.length?(u(),p(v,{key:1},[e.orgs.length>1?(u(),p(a,{key:0,id:"person-roles-org",label:"Org",options:e.orgs,valueKey:"org",labelKey:"fmtOrg",modelValue:e.org,"onUpdate:modelValue":n[1]||(n[1]=n=>e.org=n)},null,8,["options","modelValue"])):g("",!0),m(i,{id:"person-roles-roles",label:e.orgs.length>1?"Roles":"",options:e.orgRoleOptions,disabledKey:"disabled",modelValue:e.orgRoles,"onUpdate:modelValue":n[2]||(n[2]=n=>e.orgRoles=n)},null,8,["label","options","modelValue"])],64)):(u(),p(l,{key:0}))])),_:1},8,["disabled","onSubmit","onCancel"])])),_:1},512)};var R=n({components:{PersonEditLists:S,PersonEditRoles:A,SButton:b,SSpinner:r},props:{onLoadPerson:{type:Function,required:!0}},setup(e){const n=k("me"),s=y(),o=l(null);i.get("/api/people/"+s.params.id).then((n=>{o.value=n.data.person,e.onLoadPerson(o.value)}));const t=l(null);const r=l(null);return{editListsModal:r,editRolesModal:t,me:n,onEditLists:async function(){await r.value.show()&&(o.value=(await i.get("/api/people/"+s.params.id)).data.person)},onEditRoles:async function(){await t.value.show()&&(o.value=(await i.get("/api/people/"+s.params.id)).data.person)},person:o}}});const F={key:0,id:"person-view-spinner"},P={key:1,id:"person-view"},M={id:"person-view-name"},N={id:"person-view-informalName"},L={id:"person-view-roles"},W={key:0,id:"person-view-emails"},$={key:0},D={key:1,class:"person-view-phone"},V=m("span",{class:"person-view-phone-label"},"(Cell)",-1),U={key:2,class:"person-view-phone"},_=m("span",{class:"person-view-phone-label"},"(Home)",-1),q={key:3,class:"person-view-phone"},O=m("span",{class:"person-view-phone-label"},"(Work)",-1),T={key:4,class:"person-view-address"},j={key:0},B={key:1},H={key:5,class:"person-view-address"},K=m("span",null,"Work Address:",-1),G={key:6,class:"person-view-address"},z=m("div",null,"Mailing Address:",-1),I={key:7,class:"person-view-clearances"},J=m("div",null,"Volunteer status:",-1),Q={key:0},X=x("Sunnyvale volunteer: "),Y=m("span",{style:{color:"red"}},"not registered.",-1),Z={key:0,style:{color:"red"}},ee={key:0,style:{color:"red"}},ne={key:1},se={key:3},oe={key:4},te=x("Background check: "),re=m("span",{style:{color:"red"}},"not completed.",-1),le={key:5},ae={key:6},ie={key:8,id:"person-view-attended"},de=m("div",null,"Events attended:",-1),pe={class:"person-view-attended"},ue={key:9,id:"person-view-notes"},ce=m("div",null,"Notes:",-1),me={class:"person-view-note"},ve={key:10,id:"person-view-unsub"},he=m("div",null,"Unsubscribe:",-1),ge={key:0},fe={key:1},we={key:2},be={key:11,id:"person-view-roles2"},ke=m("div",null,"Roles:",-1),ye={key:0},Ce={key:1},xe=x("Edit"),Se={key:12,id:"person-view-lists"},Ee=m("div",null,"Lists:",-1),Ae={key:0},Re=x("Edit");R.render=function(e,n,s,o,t,r){const l=d("SSpinner"),a=d("SButton"),i=d("PersonEditRoles"),f=d("PersonEditLists");return e.person?(u(),p("div",P,[m("div",M,[m("div",N,[m("span",{textContent:h(e.person.informalName)},null,8,["textContent"]),e.person.callSign?(u(),p("span",{key:0,id:"person-view-callSign",textContent:h(e.person.callSign)},null,8,["textContent"])):g("",!0)]),e.person.formalName!==e.person.informalName?(u(),p("div",{key:0,id:"person-view-formalName",textContent:h(`(formally ${e.person.formalName})`)},null,8,["textContent"])):g("",!0)]),m("div",L,[(u(!0),p(v,null,C(e.person.roles,(e=>(u(),p("div",{textContent:h(e.name)},null,8,["textContent"])))),256))]),e.person.email?(u(),p("div",W,[m("div",null,[m("a",{href:"mailto:"+e.person.email,textContent:h(e.person.email)},null,8,["href","textContent"])]),e.person.email2?(u(),p("div",$,[m("a",{href:"mailto:"+e.person.email2,textContent:h(e.person.email2)},null,8,["href","textContent"])])):g("",!0)])):g("",!0),e.person.cellPhone?(u(),p("div",D,[m("a",{href:"tel:"+e.person.cellPhone,textContent:h(e.person.cellPhone)},null,8,["href","textContent"]),V])):g("",!0),e.person.homePhone?(u(),p("div",U,[m("a",{href:"tel:"+e.person.homePhone,textContent:h(e.person.homePhone)},null,8,["href","textContent"]),_])):g("",!0),e.person.workPhone?(u(),p("div",q,[m("a",{href:"tel:"+e.person.workPhone,textContent:h(e.person.workPhone)},null,8,["href","textContent"]),O])):g("",!0),e.person.homeAddress&&e.person.homeAddress.address?(u(),p("div",T,[m("div",null,[e.person.workAddress&&e.person.workAddress.sameAsHome?(u(),p("span",j,"Home Address (all day):")):(u(),p("span",B,"Home Address:")),m("a",{class:"person-view-map",target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(e.person.homeAddress.address)},"Map",8,["href"])]),m("div",{textContent:h(e.person.homeAddress.address.split(",")[0])},null,8,["textContent"]),m("div",{textContent:h(e.person.homeAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"]),e.person.homeAddress.fireDistrict?(u(),p("div",{key:0,textContent:h("Sunnyvale Fire District "+e.person.homeAddress.fireDistrict)},null,8,["textContent"])):g("",!0)])):g("",!0),e.person.workAddress&&e.person.workAddress.address?(u(),p("div",H,[m("div",null,[K,m("a",{class:"person-view-map",target:"_blank",href:"https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(e.person.workAddress.address)},"Map",8,["href"])]),m("div",{textContent:h(e.person.workAddress.address.split(",")[0])},null,8,["textContent"]),m("div",{textContent:h(e.person.workAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"]),e.person.workAddress.fireDistrict?(u(),p("div",{key:0,textContent:h("Sunnyvale Fire District "+e.person.workAddress.fireDistrict)},null,8,["textContent"])):g("",!0)])):g("",!0),e.person.mailAddress&&e.person.mailAddress.address?(u(),p("div",G,[z,m("div",{textContent:h(e.person.mailAddress.address.split(",")[0])},null,8,["textContent"]),m("div",{textContent:h(e.person.mailAddress.address.replace(/^[^,]*, */,""))},null,8,["textContent"])])):g("",!0),e.person.dsw||void 0!==e.person.volgistics||void 0!==e.person.backgroundCheck?(u(),p("div",I,[J,!1===e.person.volgistics?(u(),p("div",Q,[X,Y])):e.person.volgistics&&!0!==e.person.volgistics?(u(),p("div",{key:1,textContent:h("Sunnyvale volunteer #"+e.person.volgistics)},null,8,["textContent"])):g("",!0),e.person.dsw?(u(!0),p(v,{key:2},C(e.person.dsw,((e,n)=>(u(),p("div",null,[x("DSW for "+h(n)+": ",1),e.needed&&!e.registered?(u(),p("span",Z,"not registered.")):(u(),p(v,{key:1},[x("registered "+h(e.registered)+", ",1),e.expired?(u(),p("span",ee,"expired")):(u(),p("span",ne,"expires")),x(" "+h(e.expires)+".",1)],64))])))),256)):g("",!0),!0===e.person.backgroundCheck?(u(),p("div",se,"Background check cleared.")):!1===e.person.backgroundCheck?(u(),p("div",oe,[te,re])):e.person.backgroundCheck?(u(),p("div",le,"Background check cleared on "+h(e.person.backgroundCheck)+".",1)):g("",!0),e.person.identification.length?(u(),p("div",ae,"IDs issued: "+h(e.person.identification.join(", ")),1)):g("",!0)])):g("",!0),e.person.attended?(u(),p("div",ie,[de,(u(!0),p(v,null,C(e.person.attended,(e=>(u(),p("div",pe,[m("span",{class:"person-view-attended-date",textContent:h(e.date)},null,8,["textContent"]),m("span",{textContent:h(e.name)},null,8,["textContent"])])))),256))])):g("",!0),e.person.notes&&e.person.notes.length?(u(),p("div",ue,[ce,(u(!0),p(v,null,C(e.person.notes,(e=>(u(),p("div",me,[m("span",{class:"person-view-note-date",textContent:h(e.date)},null,8,["textContent"]),m("span",{textContent:h(e.note)},null,8,["textContent"])])))),256))])):g("",!0),e.person.noEmail||e.person.noText?(u(),p("div",ve,[he,e.person.noEmail&&e.person.noText?(u(),p("div",ge,"from all emails and text messages")):e.person.noEmail?(u(),p("div",fe,"from all emails")):(u(),p("div",we,"from all text messages"))])):g("",!0),e.me.webmaster?(u(),p("div",be,[ke,(u(!0),p(v,null,C(e.person.roles2,(e=>(u(),p("div",{textContent:h(e)},null,8,["textContent"])))),256)),e.person.roles2.length?g("",!0):(u(),p("div",ye,"None")),e.person.canEditRoles2?(u(),p("div",Ce,[m(a,{variant:"secondary",small:"",onClick:e.onEditRoles},{default:c((()=>[xe])),_:1},8,["onClick"])])):g("",!0),m(i,{ref:"editRolesModal",pid:e.person.id},null,8,["pid"])])):g("",!0),e.me.webmaster&&e.person.lists?(u(),p("div",Se,[Ee,(u(!0),p(v,null,C(e.person.lists,(e=>(u(),p("div",{textContent:h(e)},null,8,["textContent"])))),256)),e.person.lists.length?g("",!0):(u(),p("div",Ae,"None")),m("div",null,[m(a,{variant:"secondary",small:"",onClick:e.onEditLists},{default:c((()=>[Re])),_:1},8,["onClick"])]),m(f,{ref:"editListsModal",pid:e.person.id},null,8,["pid"])])):g("",!0)])):(u(),p("div",F,[m(l)]))};export default R;
